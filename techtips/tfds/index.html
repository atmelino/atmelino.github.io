<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" href="../../css/blog.css" media="all" rel="stylesheet">
  <title></title>
</head>

<body>

  <div class="header">
    <table id="headerline_table">
      <tr>
        <td width="200">
          <a href="../../index.html"><img src="../../images/home.png" alt="home" height="60"></a>
          <a href="../../techtips/index.html"><img src="../../images/techtips.png" alt="scroll" height="60"></a>
          <a href="../../techtips/pytorch/index.html"><img src="../../images/pytorch.png" alt="pytorch" height="60"></a>
        </td>
        <td id="headerline_cell">
          <h2>Tensorflow tfds</h2>
        </td>
      </tr>
    </table>
  </div>

  <div class="row">
    <div class="leftcolumn">


      <div class="card">
        <h3>Project Web Sites</h3>
        <p>
          <a href="https://www.tensorflow.org/datasets/api_docs/python/tfds">
            https://www.tensorflow.org/datasets/api_docs/python/tfds
          </a><br>
          <br>
          <a
            href="https://colab.research.google.com/github/tensorflow/datasets/blob/master/docs/overview.ipynb#scrollTo=VZZyuO13fPvk">
            https://colab.research.google.com/github/tensorflow/datasets/blob/master/docs/overview.ipynb#scrollTo=VZZyuO13fPvk
          </a><br>
          <br>
          <a href="https://stackoverflow.com/questions/64114707/create-your-own-tfds-load">
            https://stackoverflow.com/questions/64114707/create-your-own-tfds-load
          </a><br>
      </div>

      <div class="card">
        <h3>Understanding tfds</h3>

        What does train_ds.take(2) do?

        train_ds is one of the return values of
        <div class="code">
          (train_ds, val_ds, test_ds), metadata = tfds.load(<br>
          'tf_flowers',<br>
          data_dir=DATA_PATH,<br>
          split=['train[:80%]', 'train[80%:90%]', 'train[90%:]'],<br>
          with_info=True,<br>
          as_supervised=True,<br>
          )
        </div>


        <h3>Process of loading datasets</h3>

        On the Overview page<br>
        <a href="https://www.tensorflow.org/datasets/api_docs/python/tfds">
          https://www.tensorflow.org/datasets/api_docs/python/tfds </a><br>
        <br>
        there is a link to a Colab tutorial:<br>
        <a href="https://colab.research.google.com/github/tensorflow/datasets/blob/master/docs/overview.ipynb">
          https://colab.research.google.com/github/tensorflow/datasets/blob/master/docs/overview.ipynb
        </a><br>
        <br>
        In the section "Load a dataset":<br>
        tfds.load() will download the data and save it as tfrecord files.<br>
        <br>
        For example, if we set the parameter data_dir to<br>
        <div class="code">
          tfds.load(<br>
          'mnist',<br>
          data_dir="local_data/tfds",<br>
        </div>

        the directory local_data/tfds/mnist/3.0.1 will contain the files
        <div class="output">
          dataset_info.json<br>
          features.json<br>
          image.image.json<br>
          mnist-test.tfrecord-00000-of-00001<br>
          mnist-train.tfrecord-00000-of-00001
        </div>

        <br>
        TFRecord and tf.train.Example<br>
        <a href="https://www.tensorflow.org/tutorials/load_data/tfrecord">
          https://www.tensorflow.org/tutorials/load_data/tfrecord </a><br>

        <a href=""> </a><br>
      </div>

      <div class="card">
        <h3>Observations</h3>

        <div class="code">
          (train_ds, validation_ds), metadata= tfds.load(<br>
          "cats_vs_dogs",<br>
          data_dir=DATA_PATH,<br>
          split=["train[:40%]", "train[40%:50%]"],<br>
          with_info=True,<br>
          as_supervised=True,<br>
          )
        </div>

        <div class="code">
          tfds.as_dataframe(train_ds.take(2), metadata)
        </div>
        <img src="../images/tfds_01.png" alt="tfds_01" height="80">

        <div class="code">
          fig = tfds.show_examples(train_ds, metadata)
        </div>
        <img src="../images/tfds_02.png" alt="tfds_02" height="80">

        <div class="code">
          plt.figure(figsize=(10, 10))<br>
          for i, (image, label) in enumerate(train_ds.take(2)):<br>
          ax = plt.subplot(3, 3, i + 1)<br>
          plt.imshow(image)<br>
          plt.title(int(label))<br>
          plt.axis("off")
        </div>
        <img src="../images/tfds_03.png" alt="tfds_03" height="80">

        <br>

        <table width="100%">
          <tr colspan="2">Effect of</tr>
          <tr>
            <td colspan="2" class="code">
              size = (150, 150)<br>
              train_ds = train_ds.map(lambda x, y: (tf.image.resize(x, size), y))<br>
            </td>
          </tr>
          <tr>
            <th>Before</th>
            <th>After</th>
          </tr>
          <tr>
            <td colspan="2" class="code">
              tfds.as_dataframe(train_ds.take(2), metadata)
            </td>
          </tr>
          <tr>
            <td> <img src="../images/tfds_01.png" alt="tfds_01" height="80"> </td>
            <td>Stallion</td>
          </tr>
          <tr>
            <td colspan="2" class="code">
              tfds.as_dataframe(train_ds.take(2), metadata)
            </td>
          </tr>
          <tr>
            <td> <img src="../images/tfds_01.png" alt="tfds_01" height="80"> </td>
            <td>Stallion</td>
          </tr>
        </table>






        <a href=""> </a><br>
      </div>




      <div class="card">
        <h2></h2>
        <a href=""> </a><br>
      </div>

    </div>
    <div class="rightcolumn">

      <div class="card">
        <h4>Category</h4>
        <a href="installation.html">Installation</a><br>
        <a href="usage.html">Usage</a><br>
      </div>

      <div class="card">
        <h3>Follow Me</h3>
        <a href="https://discord.gg/F7KQySEW"><img src="../../images/discord.png" alt="discord" height="30"></a>
      </div>
    </div>
  </div>
  </div>
  <div class="footer">
    <h3>Modified July 2023</h3>
  </div>
</body>

</html>