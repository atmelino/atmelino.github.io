<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" href="../css/blog.css" media="all" rel="stylesheet">
  <title>cncjs Autolevel</title>
</head>

<body>
  <div class="header">
    <table id="headerline_table">
      <tr>
        <td width="240">
          <a href="../index.html"><img src="../images/home.png" alt="home" height="60"></a>
          <a href="../cncjsAL/index.html"><img src="../images/cncjsAL.png" alt="scroll" height="60"></a>
          <a href="../cncjsAL/install.html"><img src="../images/cncjsAL_install.png" alt="git" height="60"></a>
        </td>
        <td id="headerline_cell">
          <h2>Installation</h2>
        </td>
      </tr>
    </table>
  </div>

  <div class="row">
    <div class="leftcolumn">


      <div class="card">
        <h2>Ubuntu and cncjs AutoLevel</h2>

        There are several ways to install cncjs:
        <ul>
          <li>source code</li>
          <li>Electron app</li>
          <li>Docker</li>
        </ul>

        AutoLevel is currently not part of official cncjs, therefore the only way to get AutoLevel is to run from source
        code.
        In this instance, we will use Ubuntu 22.04 as the operating system.<br>
        We will install cncjs with the AutoLevel modification from the source code, build the project,
        and run the app.<br>

        <p>
          Open a terminal in Ubuntu.
        </p>

        <h4>Install node version manager nvm</h4>
        The current AutoLevel widget is based on cncjs version 1.10.3.
        cncjs 1.10.3 will not run with the latest node version, but it will run with node version 14.<br>
        The node version manager nvm allows to choose the node version.<br>
        <div class="code">
          curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
        </div>
        <p>log out and back in so that .bash_rc is run</p>
        <p>List available versions:</p>
        <p>
        <div class="code">
          nvm list-remote </div>
        </p>

        <h4>Install node</h4>
        Install node version 14 by<br>
        <div class="code">
          nvm install 14
        </div>

        <h4>Switch node version</h4>
        Every time we open the terminal, we have to make sure that we are using node version 14.<br>
        There are ways to make this switch permanent, but I have tried and they didn't work, leading to errors that were
        hard to trace.<br>
        The saftest way to ensure the correct node version is to run this every time you open the terminal:<br>
        <div class="code">
          nvm use 14
        </div>

        <h4>Install yarn</h4>
        yarn is the package manager used to manage this project.<br>
        Install yarn:<br>
        <div class="code">
          npm install -g yarn
        </div>

        <h4>Retrieve the source code</h4>
        Clone the cncjs repository with the AutoLevel modification to your local computer<br>
        <div class="code">
          git clone https://github.com/atmelino/cncjs_1_10_3_AL.git
        </div>
        and switch to the folder in which cncjs_1_10_3_AL is installed.<br>
        <div class="code">
          cd cncjs_1_10_3_AL
        </div>

        <h4>Initial project install</h4>
        Run
        <div class="code">
          yarn
        </div>
        to install the dependencies, then run
        <div class="code">
          yarn build
        </div>
        to build the app.
        <h4>Start the cncjs server</h4>
        Run
        <div class="code">
          bin/cncjs
        </div>
        You should see something similar to this:<br>
        <p>
          <img src="images/start_cncjs.png" alt="start_cncjs" width="" height=""> <br>
        </p>

        Hold the CTRL-key on the keyboard and mouse-click on the link<br>
        <a href="http://127.0.1.1:8000/">http://127.0.1.1:8000/ </a><br>

        You should see a browser opening, displaying the workspace of cncjs<br>
        <p>
          <img src="images/Workspace.png" alt="Workspace" width="600"> <br>
        </p>

        <h4>Arduino Serial Port Permission</h4>

        <p>
          The GRBL software runs on an Arduino, for example an Arduino Mega.
          When the Arduino Mega is connected, the port appears in the Connection widget as /dev/ttyACM0.
        </p>
        However, an error message may appear:<br>
        "Error opening serial port"<br>
        <img src="images/port_01.png" alt="home" width="">
        <p><a href="https://www.arduino.cc/en/Guide/Linux#toc6">https://www.arduino.cc/en/Guide/Linux#toc6</a></p>
        To resolve:<br>

        Test current permissons:<br>
        <div class="code">
          ls -l /dev/ttyACM*
        </div>
        gives<br>
        <div class="code">
          crw-rw---- 1 root dialout 188, 0 5 apr 23.01 ttyACM0
        </div>
        so root is owner.<br>
        <br>
        Solution: add our user to the group:<br>

        <div class="code">
          sudo usermod -a -G dialout user
        </div>
        <p>
          To put the change into effect:<br><br>
          logging out and back in should theoretically work,<br>
          but in my case, only rebooting worked.
        </p>


      </div>


      <div class="card">
        <a href=""> </a><br>

      </div>

    </div>

    <div class="rightcolumn">

      <div class="card">
        <h3>Category</h3>
        <h4><a href="install.html">Installation</a></h4>
        <h4><a href="manual.html">User Manual</a></h4>
      </div>

      <div class="card">
        <h3>Follow Me</h3>
        <a href="https://discord.gg/F7KQySEW"><img src="images/discord.png" alt="discord" height="30"></a>
      </div>
    </div>

  </div>
  <div class="footer">
    <h3>Modified July 2023</h3>  </div>
</body>

</html>