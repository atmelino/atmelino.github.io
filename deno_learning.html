<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" href="css/blog.css" media="all" rel="stylesheet">
  <title></title>
</head>

<body>
  <div class="header">
    <h2>deno learning blog<br>
    </h2>
  </div>
  <div class="row">
    <div class="leftcolumn">
      <div class="card">
        <h2>Dec 15, 2022<br>
        </h2>
        deno is a javascript runtime environment that may replace
        nodejs.<br>
        <br>
        <a moz-do-not-send="true" href="https://deno.land/">https://deno.land/</a><br>
        <br>
        Clicking on Docs/Manual leads to Getting Started section.<br>
        <br>
        Installation on Ubuntu 22.04<br>
        <br>
        snap offers version v1.27.2:<br>
        <br>
        <div class="code"> snap find deno<br>
          Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          Version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          Publisher&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          Notes&nbsp; Summary<br>
          deno&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          v1.27.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          lukewh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A secure runtime for
          JavaScript and TypeScript<br>
        </div>
        <br>
        The current version appears to be v1.29.1 (from
        https://deno.land/manual@v1.29.1/introduction)\ <br>
        I can't find a PPA so I guess we'll go with snap for now. <br>
        I use Visual Studio Code so let's install Deno for Visual
        Studio Code: <br>
        <br>
        <a moz-do-not-send="true"
          href="https://marketplace.visualstudio.com/items?itemName=denoland.vscode-deno">https://marketplace.visualstudio.com/items?itemName=denoland.vscode-deno</a><br>
        <br>
        Usage explained at<br>
        <a moz-do-not-send="true"
          href="https://deno.land/manual@v1.29.1/references/vscode_deno">https://deno.land/manual@v1.29.1/references/vscode_deno</a><br>
        <br>
        Start with first examples.<br>
        <a moz-do-not-send="true"
          href="https://deno.land/manual@v1.29.1/getting_started/first_steps">https://deno.land/manual@v1.29.1/getting_started/first_steps</a><br>
        <br>
        Created first_steps.ts and try to run<br>
        <br>
        Result:<br>
        <div class="code"> deno run first_steps.ts<br>
          A new release of Deno is available: 1.27.2 &#8594; 1.29.1 Run
          `deno upgrade` to install it.<br>
          error: Permission denied (os error 13)<br>
          <br>
          Caused by:<br>
          &nbsp;&nbsp;&nbsp; Permission denied (os error 13)<br>
          <br>
        </div>
        Try to&nbsp; upgrade deno:<br>
        <div class="code"> deno upgrade<br>
          You are running the Deno snap. The upgrade command is
          unavailable.<br>
          The snap is updated automatically after a new release of
          Deno.<br>
          You can force an update by running the command:<br>
          &nbsp;&nbsp;&nbsp; snap refresh deno<br>
        </div>
        <br>
        <br>
        On second thought, remove snap and install via curl method.<br>
        <br>
        <div class="code"> curl -fsSL
          https://deno.land/x/install/install.sh | sh<br>
        </div>
        <br>
        Now the example works!<br>
      </div>
      <div class="card">
        <h2>Dec 23, 2022</h2>
        <p>Create a deno app with React<br>
        </p>
        <p>Example with React:<br>
        </p>
        <a moz-do-not-send="true"
          href="https://deno.com/blog/frameworks-with-npm#react">https://deno.com/blog/frameworks-with-npm#react</a><br>
        <p>video guide:<br>
          <a moz-do-not-send="true"
            href="https://www.youtube.com/watch?v=eStwt_2THd8">https://www.youtube.com/watch?v=eStwt_2THd8</a><br>
        </p>
        <p>source code here:<br>
          <a moz-do-not-send="true"
            href="https://github.com/denoland/examples/tree/main/with-react">https://github.com/denoland/examples/tree/main/with-react</a><br>
        </p>
        <h3>Attempt 1: follow step by step instructions from web page</h3>
        <div class="code"> deno run --allow-read --allow-write
          --allow-env npm:create-vite-extra@latest&nbsp; project name:
          dinosaur-react-app<br>
        </div>
        <p>choose template: deno-react<br>
        </p>
        <p>Project name: react<br>
          &#10004; Select a template: � deno-react<br>
          ? Select a variant: � - Use arrow-keys. Return to submit.<br>
          &#10095;&nbsp;&nbsp; JavaScript<br>
          &nbsp;&nbsp;&nbsp; TypeScript<br>
          &nbsp;&nbsp;&nbsp; JavaScript + SWC<br>
          &nbsp;&nbsp;&nbsp; TypeScript + SWC</p>
        <p>which one? don't know, also option does not appear in the
          video<br>
          chose Javascript, seems to work<br>
        </p>
        <p>This creates a folder named node_modules with 2,902 items
          (and 118 hidden), totalling 218.6&nbsp;MB. No thank you.
          Exclude from pushing to github with .gitignore file.</p>
      </div>

      <div class="card">
        <h2>Dec 24, 2022</h2>
        <h3>Attempt 1: follow step by step instructions, continued </h3>
        start the API server with<br>
        <br>
        <div class="code">deno run --allow-env --allow-net api/main.ts
        </div>
        <br>
        and open a browser at <a href="http://localhost:8000/">localhost:8000</a><br>
        <br>
        works!<br>
        <br>
        create the other folders and files.<br>
        <br>
        Now try to start the app:
        <br>
        <div class="code">deno task run </div>
        <br>
        does not work - task not available (also, is not listed in
        deno.json)<br>
        <br>
        <div class="code">deno task dev </div>
        <br>
        works partially: <br>
        <br>
        open a browser at <a moz-do-not-send="true" href="http://localhost:5173/">http://localhost:5173/</a><br>
        <br>
        brings up "Welcome to the Dinosaur app"<br>
        <br>
        but error: <br>
        Index.jsx:7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        GET http://localhost:8000/api/ net::ERR_CONNECTION_REFUSED<br>
        <br>
        (developer console opened with CTRL-J)<br>
        <br>
        <h3>Attempt 2: download source code and run </h3>
        start the API server with<br>
        <br>
        <div class="code">deno run --allow-env --allow-net api/main.ts
        </div>
        <br>
        and open a browser at<br>
        <a href="http://localhost:8000/">localhost:8000</a><br>
        <br>
        works here as well<br>
        <br>
        Now try to start the app:
        <div class="code">deno task preview </div>
        A few files are being downloaded (probably node_modules)<br>
        Then error<br>
        TypeError: Invalid package specifier 'npm:react-dom/client@^18.2'. Did you mean to write
        'npm:react-dom@^18.2/client'?<br>
        Same error occurs when starting with<br>
        <div class="code">deno task dev </div>
        This error is described in issue<br>
        <a href="https://github.com/denoland/examples/issues/7">https://github.com/denoland/examples/issues/7</a>
        Try
        <br>
        Easily soved by changing npm:react-dom/client@^18.2' to 'npm:react-dom@^18.2/client
        <br>
        in file
        <br>
        vite.config.mjs
        <br>
        now the app can be started with
        <div class="code">deno task dev </div>
        Leads to output<br>
        <div class="code"> VITE v3.2.2 ready in 431 ms<br>
          Local: http://localhost:5173/<br>
          Network: use --host to expose
        </div>
        As in attempt 1, opening the browser at the specified address brings up the welcome message<br>
        but also the same error.

      </div>

      <div class="card">
        <h2>Dec 26, 2022</h2>
        <h3>deno based UI framework</h3>
        Which one?<br>
        Comparison, but from 2020:<br>
        <a href="https://dev.to/craigmorten/what-is-the-best-deno-web-framework-2k69">
          https://dev.to/craigmorten/what-is-the-best-deno-web-framework-2k69</a>
        <br>
        From the deno website:<br>
        <a href="https://deno.land/manual@v1.28.0/getting_started/web_frameworks">
          https://deno.land/manual@v1.28.0/getting_started/web_frameworks</a>
        <br>
        It says that Fresh is the most popular one:<br>
        <a href="https://fresh.deno.dev/">
          https://fresh.deno.dev/</a>
        Create the empty new project:<br>
        <div class="code">deno run -A -r https://fresh.deno.dev my-project</div>
        <br>
        It generates the following folder tree:<br>

        <div class="flexbox">
          <div class="left">
            <img src="images/tree.jpg" alt="hello World">

          </div>
          <div class="right">
            <pre>├── <font color="#12488B"><b>components</b></font>
              │   └── Button.tsx
              ├── deno.json
              ├── deno.lock
              ├── <font color="#26A269"><b>dev.ts</b></font>
              ├── fresh.gen.ts
              ├── import_map.json
              ├── <font color="#12488B"><b>islands</b></font>
              │   └── Counter.tsx
              ├── main.ts
              ├── README.md
              ├── <font color="#12488B"><b>routes</b></font>
              │   ├── <font color="#12488B"><b>api</b></font>
              │   │   └── joke.ts
              │   ├── index.tsx
              │   └── [name].tsx
              ├── <font color="#12488B"><b>static</b></font>
              │   ├── favicon.ico
              │   └── <font color="#A347BA"><b>logo.svg</b></font>
              └── twind.config.ts
              </pre>

          </div>
        </div>


        start it with<br>
        <div class="code">deno task start</div>
        and open a browser at <a href="http://localhost:8000/">localhost:8000</a><br>
        <h4>configuration management</h4>
        Updating Fresh page under docs lists Fresh versions as well as versions of dependencies:<br>
        <a href="https://fresh.deno.dev/docs/concepts/updating">https://fresh.deno.dev/docs/concepts/updating</a><br>
        The file "import_map.json" lists the versions and Dependency versions.<br>

      </div>

      <div class="card">
        <h2>Dec 27, 2022</h2>
        <p>Note: Working with Visual Studio Code<br>
          Open the folder that is the root of the project, otherwise all kinds of errors will show up.
        </p>
        <p>Working through the tutorial at<br>
          <a href="https://fresh.deno.dev/docs/getting-started">https://fresh.deno.dev/docs/getting-started</a><br>
        </p>
        <p>
        <h4>Chapter 2.3: Create a route</h4>
        "Route files that render HTML are JavaScript or TypeScript
        modules that export a JSX component as their default export. "
        </p>
        <p>Create a file named about.tsx in the routes folder.<br>
          The object defined in this file will be displayed as a static web page at<br>
          <a href="http://localhost:8000/about">http://localhost:8000/about</a><br>
        </p>
        <p>Create a folder named testFolder under routes.<br>
          add file named test.tsx in the new folder with static web page content.<br>
          It will be displayed at<br>
          <a href="http://localhost:8000/testFolder/test">http://localhost:8000/testFolder/test</a><br>
        </p>
        <p>Observation:<br>
          - add a folder under routes,<br>
          start the program with with<br>
        <div class="code">deno task start</div>
        which is translated into<br>
        <div class="code">deno run -A --watch=static/,routes/ dev.ts</div>
        so watch option is active (code updated reflected in running code)<br>
        Message comes up:<br>
        <div class="code">Watcher Process started.</div>
        <div class="code">The manifest has been generated for 6 routes and 1 islands.</div>
        and in the file fresh.gen.ts<br>
        the new folder is listed as one of the imports, the code for this import has been autogenerated.
        </p>

        <h4>Chapter 2.4: Dynamic routes</h4>
        <p>
          The project created with the deno command contains a file named [name].tsx in the folder routes.<br>
          When I go to <br>
          <a href="http://localhost:8000/Benny">http://localhost:8000/Benny</a><br>
          the page shows "Hello Benny"<br>
          in other words a dynamically created page from routes/[name].tsx.
        </p>
        <p>
          However, when create a folder named greet under routes and add the [name].tsx file
          and open a browser at<br>
          <a href="https://localhost:8000/greet/Luca">https://localhost:8000/greet/Luca</a><br>
          I just get an error.
        </p>
      </div>


      <div class="card">
        <h2>Dec 28, 2022</h2>
        <p> Dynamic routes with folders, found the solution: <br>
          Local host does not work with the https prefix.<br>
          This works:<br>
          <a href="http://localhost:8000/greet/Luca">http://localhost:8000/greet/Luca</a><br>
        </p>

        <h4>Chapter 2.5: Custom handlers</h4>
        <p>
          modified about.tsx, so that it adds a custom header.<br>
          Don't know how to verify that the header was modified.<br>
          But added a line<br>
          <class code>console.log("handler in about.tsx called");</class>
          in the handler and the message shows up in the terminal when I load or reload the about page.
          <a href="http://localhost:8000/about">http://localhost:8000/about</a><br>
        </p>

        <h4>Chapter 2.6: Fetching data</h4>
        <p>>Create folder routes/github<br>
          Create file named [username].tsx in this folder and paste code from tutorial.

          and open a browser at<br>
          <a href="http://localhost:8000/github/atmelino">http://localhost:8000/github/atmelino</a><br>
          Shows github username and profile picture!
        </p>
      </div>

      <div class="card">
        <h2>Dec 29, 2022</h2>
        <h3>Deployment</h3>
        <h4>Manual start</h4>
        <p>
          on a Linode server with Ubuntu 20.04:<br>
          Installed deno with the curl method.<br>
          used git to clone the code into a folder <br>
          The first_steps code works:
        <div class="code">deno run --allow-net --allow-write http_server.ts</div>
        and open a browser at<br>
        <a href="http://myservername:8000">http://myservername:8000</a><br>
        <class code></class>
        The code in the deno_fresh_01 folder does not work:
        <div class="code">deno task start</div>
        gives
        <div class="code">error: The source code is invalid, as it does not match the expected hash in the lock file.
        </div>
        However, after removing the deno.lock file, the code works.
        </p>
        <p>
        <h4>pm2</h4>
        There are tools available to simplify the deployment process, and also we want the web site
        to start automatically when the server is rebooted.<br>
        If you use a cloud provider such as AWS, DigitalOcean, Azure, you can use pm2:<br>

        <a href="https://stackoverflow.com/questions/62081683/how-to-use-deno-in-production">
          https://stackoverflow.com/questions/62081683/how-to-use-deno-in-production</a><br>

        <a href="https://github.com/denoland/deno/issues/7137">https://github.com/denoland/deno/issues/7137</a><br>

        <a href="https://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/#start-any-process-type">
          https://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/#start-any-process-type</a><br>
        </p>

        <p>
        <h4>Using Systemd</h4>
        <a href="https://dev.to/alexanderalemayhu/run-deno-apps-via-systemd-on-linux-1ok2">
          https://dev.to/alexanderalemayhu/run-deno-apps-via-systemd-on-linux-1ok2</a><br>

        <div class="code">sudo touch /etc/systemd/system/denoapp_01.service</div>

        Copy and modify the contents as shown on web site<br>

        Enable and start it:<br>
        <div class="code">sudo systemctl enable denoapp_01</div>
        <div class="code">sudo systemctl start denoapp_01</div>

        Monitor status:<br>
        <div class="code">sudo systemctl status denoapp_01</div>

        View journal log:<br>
        <div class="code">sudo journalctl -u denoapp_01</div>


        It took a bit of tweaking until it actually ran.<br>

        Here is the working service file:<br>
        <div class="code">
          [Unit]<br>
          Description=deno_fresh_01 - deno example<br>
          Documentation=https://my-cool-thing.io/docs<br>
          After=network.target<br>
          <br>
          [Service]<br>
          Type=simple<br>
          User=atmelino<br>
          WorkingDirectory=/home/atmelino/github/learn/deno/deno_Fresh/deno_fresh_01<br>
          ExecStart=/usr/local/bin/deno run --allow-env --allow-read --allow-write --allow-net --allow-run main.ts<br>
          <br>
          Restart=on-failure<br>
          <br>
          [Install]<br>
          WantedBy=multi-user.target<br>
        </div>
        </p>
      </div>

      <div class="card">
        <h2>Dec 30, 2022</h2>
        <h4>Chapter 2.7: Form submissions</h4>
        How to start it?<br>
        <a href="http://localhost:8000/search">http://localhost:8000/search</a><br>
        results in a page not found error.<br>
        If I copy the contents of about.tsx into search.tsx, then the about page is loaded with the above link,
        so the file name and location are not the problem.<br>
        <br>
        created a new file named tmpsearch.tsx and it worked.<br>
        Pasted the original code into search.tsx and now search.tsx works as well!<br>
        Must have been something about reloading the app or similar<br>
        <p> Upon loading, the page shows all available names.<br>
          When entering one of the names in the URL<br>
          <a href="http://localhost:8000/search?q=Alice">http://localhost:8000/search?q=Alice</a><br>
          the page will show only that name.
        </p>
        <h4>Deployment</h4>
        <p>
          When I pull the new code to the web server, the web site is not updated<br>
          (watch flag not enabled)<br>
        <div class="code">git pull</div>
        I can get deno to show the updated web page with<br>
        <div class="code">sudo systemctl restart denoapp_01.service</div>
        Note:<br>
        The links with localhost do not work now because we are on the web server.<br>
        This would be a good time to use variables for getting the base URL and using it in the links<br>
        </p>
        <h4>Chapter 2.8: Adding interactivity</h4>
        The example loads at <br>
        <a href="http://localhost:8000/countdown">http://localhost:8000/countdown</a><br>
        because the lowercase countdown.tsx file is in the routes folder.<br>

      </div>

      <div class="card">
        <h2>Date</h2>
        New Card
      </div>


      <div class="card">
        <h2>Updated: Dec 30, 2022</h2>
        <h3>Concepts: File name extensions</h3>

        <table id="customers">
          <tr>
            <th>Extension</th>
            <th>Type</th>
            <th>Description</th>
            <th>Link</th>
          </tr>
          <tr>
            <td>js</td>
            <td>Javascript</td>
            <td>Code</td>
            <td>Code</td>
          </tr>
          <tr>
            <td>ts</td>
            <td>TypeScript</td>
            <td>Code</td>
            <td>Code</td>
          </tr>
          <tr>
            <td>jsx</td>
            <td></td>
            <td>
              JSX files describe what the UI should look like (HTML elements, etc.)
            </td>
            <td><a href="https://reactjs.org/docs/introducing-jsx.html">jsx</a><br></td>
          </tr>
        </table>
        Other learning pages:<br>
        <p>
          <a href="https://blog.logrocket.com/getting-started-deno-fresh/#setting-up-database">
            https://blog.logrocket.com/getting-started-deno-fresh/#setting-up-database</a><br>
          <a href="https://github.com/rosdec/deno_fresh_heroes">
            https://github.com/rosdec/deno_fresh_heroes</a><br>
        </p>
        <p>
          <a href="https://deno.land/manual@v1.29.1/examples">
            https://deno.land/manual@v1.29.1/examples</a><br>
        </p>


      </div>
    </div>

    <div class="rightcolumn">
      <div class="card">
        <h2>Blog List<br>
        </h2>
        <a moz-do-not-send="true" href="index.html">atmelinos' blogs</a><br>
      </div>
      <div class="card">
        <h3>Posts by Date<br>
        </h3>
        <div class="fakeimg">Image</div>
        <br>
        <div class="fakeimg">Image</div>
        <br>
      </div>
      <div class="card">
        <h3>Follow Me</h3>
        <p>Some text..</p>
      </div>
    </div>
  </div>
  <div class="footer">
    <h2>More coming soon..<br></h2>
  </div>
</body>

</html>