<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" href="../../css/blog.css" media="all" rel="stylesheet">
  <title></title>
</head>

<body>

  <div class="header">
    <table id="headerline_table">
      <tr>
        <td width="200">
          <a href="../../index.html"><img src="../../images/home.png" alt="home" height="60"></a>
          <a href="../../blogs/index.html"><img src="../../images/scroll.png" alt="scroll" height="60"></a>
          <a href="../../blogs/AI_learning/index.html"><img src="../../images/AI_01.png" alt="deno" height="60"></a>
        </td>
        <td>
          <h2>AI learning blog May 2025 </h2>
        </td>
      </tr>
    </table>
  </div>


  <div class="row">
    <div class="leftcolumn">


      <div class="card">
        <h2>May 10, 2025</h2>
        J. Heaton class chapter 8.2, "Evaluating Feature Importance"<br><br>

        "More important inputs will produce a less accuratescore when they are removed by shuffling them."<br<br>

          The function perturbation_rank() works as follows:<br><br>
          - shuffle each input column<br>
          - compute the prediction<br>
          - compute the error as log_loss between prediction and actual y values.<br>
          <br>
          The following table shows the difference between prediction and y in each case:<br><br>
          <table style="width: 50%">
            <tr>
              <td>sl</td>
              <td>sw</td>
              <td>pl</td>
              <td>pw</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>1</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-2</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>2</td>
              <td>1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>1</td>
              <td>-1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-2</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-2</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>2</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>-1</td>
              <td>-1</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
          </table>
          <br>
          It is apparent that the column petal_l has far more errors than the other columns, therefore it is regarded as
          more important.

      </div>


      <div class="card">
        <h2>May 14, 2025</h2>

        The code in the chapter "Biological Response with Neural Network" in module 8 part 2 does not run, giving the
        error:<br>
        <div class="output">
          ModuleNotFoundError: No module named 'tensorflow.keras.wrappers'
        </div>

        Brave search "ModuleNotFoundError: No module named 'tensorflow.keras.wrappers'",<br>
        AI recommends two options:<br>
        <p>
          "As of TensorFlow 2.15, the wrappers submodule under tensorflow.keras has been removed. To resolve this issue,
          you can either uninstall the current version of TensorFlow and install an earlier version where the wrappers
          submodule is still available,"
        </p>
        <h5>Attempt 1</h5>
        <div class="code">
          pip install scikeras
        </div>
        in the existing jh_class environment failed.
        failed

        <h5>Attempt 2</h5>
        <div class="code">
          conda create -n ensemble python=3.7
        </div>
        <div class="code">
          conda install -c conda-forge numpy -y<br>
          conda install -c conda-forge pandas -y<br>
          conda install -c conda-forge tensorflow -y<br>
          pip install scikit-learn<br>
        </div>
        This works.

        <a href=""> </a><br>
      </div>

      <div class="card">
        <h2>May 15, 2025</h2>

        The jupyter notebook shows a depracation warning, recommending to visit<br>

        <a href="https://adriangb.com/scikeras/stable/migration.html">
          https://adriangb.com/scikeras/stable/migration.html </a><br>

        <br>

        <a href="https://adriangb.com/scikeras/stable/">
          https://adriangb.com/scikeras/stable/ </a><br>
        <br>


        <a href=""> </a><br>
      </div>


      <div class="card">
        <h2>May 16, 2025</h2>
        What does model.predict_proba() do? <br><br>
        Brave search "kera api predict_proba":<br>
        "this function has been deprecated in Tensorflow version 2.6 and later versions of Keras. Instead, you should
        use the predict() function directly to achieve similar results."<br>
        <br>
        Where is the source code for the function predict_proba() ?<br><br>

        Open terminal.<br>
        <div class="code">
          cd ~/miniconda3/envs/ensemble/lib/python3.7<br>
          grep -r "def predict_proba("
        </div>
        This will list a number of files, such as<br>
        <div class="output">
          site-packages/keras/wrappers/scikit_learn.py:<br>
          def predict_proba(self, x, **kwargs):
        </div>
        This is the function that is called when the model is Sequential().<br>
        <p>
          The function predict_proba() basically just calls predict().
        </p>
        <a href=""> </a><br>
      </div>

      <div class="card">
        <h2>May 16, 2025</h2>
        <h3>Structure of class_08_2_keras_ensembles_bio_blend.py</h3>

        <h5>main program</h5>
        The file bio_train.csv contains the training data.<br>
        It contains and 3751 rows and 1777 columns.<br>
        The first column named "activity" is the target.<br>
        All the other columns are the predictors.<br>
        <ul>
          <li>The predictor values are read into the variable x and it is of shape (3751, 1776)</li>
          <li>The target values are read into the variable y and it is of shape (3751,)</li>
        </ul>
        The file bio_test.csv contains the data for which a prediction will be made.<br>
        It contains and 2501 rows and 1776 columns.<br>
        Since it is meant for the Kaggle submission, it does not contain the target
        column ("solution")<br>
        <ul>
          <li>The predictor values for the submission are read into the variable x_submit and it is of shape (2501,
            1776)</li>
        </ul>

        The blend_ensemble(x, y, x_submit) is called and it returns the variable submit_data which is of shape (2501,
        2).<br>
        <br>
        The values in submit_data are then stretched such that the smallest value becomes 0 and the largest value
        becomes 1.<br>
        <br>
        Finally, an index column and the column 1 (second column) of submit_data are provided with the labels
        "MoleculeId" and "PredictedProbability" and saved to the submission file named "submit.csv".

        <a href=""> </a><br>
      </div>

      <div class="card">
        <h2>May 18, 2025</h2>

        <h5>blend_ensemble() function</h5>
        The blend_ensemble() function starts by generating the indices for a stratified KFold.<br>
        Use<br>
        <ul>
          <li>KFold When dealing with a regression problem.</li>
          <li>StratifiedKFold When dealing with a classification problem.</li>
        </ul>

        <h5>Use of a Stratified KFold with a single model</h5>

        The function
        <div class="code">
          kf.split(x,y)
        </div>
        simply generates indices for the elements of the dataset.<br><br>

        Each fold contains the indices of all elements, just in different variations.<br><br>
        Example:<br>
        The dataset is
        <div class="code">
          x = np.array([[1.1, 1.2], [2.1, 2.2], [3.1, 3.2], [4.1, 4.2], [5.1,5.2], [6.1, 6.2]])<br>
          y = np.array(["cat", "rabbit", "rabbit", "cat", "rabbit", "cat"])
        </div>
        Then the code
        <div class="code">
          kf = StratifiedKFold(2)<br>
          for i, (train_index, test_index) in enumerate(kf.split(x,y)):<br>
          print() etc.
        </div>
        produces the following 2 folds:<br>
        <table style="width:90%">
          <tr>
            <th> </th>
            <th> Fold 0</th>
            <th> Fold 1</th>
          </tr>
          <tr>
            <td style="width:10%">
              <br>
              index<br>
              x values<br>
              y values<br><br>
              <br>
              index<br>
              x values<br>
              y values
            </td>
            <td style="width:40%">
              Train:<br>
              [2 4 5]<br>
              [[3.1 3.2]
              [5.1 5.2]
              [6.1 6.2]]<br>
              ['rabbit' 'rabbit' 'cat']<br><br>
              Test:<br>
              [0 1 3]<br>
              [[1.1 1.2]
              [2.1 2.2]
              [4.1 4.2]]<br>
              ['cat' 'rabbit' 'cat']
            </td>
            <td style="width:40%">
              Train:<br>
              [0 1 3]<br>
              [[1.1 1.2]
              [2.1 2.2]
              [4.1 4.2]]<br>
              ['cat' 'rabbit' 'cat']<br><br>
              Test:<br>
              [2 4 5]<br>
              [[3.1 3.2]
              [5.1 5.2]
              [6.1 6.2]]<br>
              ['rabbit' 'rabbit' 'cat']
            </td>
          </tr>
        </table>

        <img src="images/kfolds1.png" alt="kfolds1" width="700">



        <h5>Using Stratified KFolds with Ensembles</h5>



        <a href=""> </a><br>
      </div>

      <div class="card">
        <h2>Date</h2>
        <a href=""> </a><br>
      </div>



    </div>

    <div class="rightcolumn">
      <div class="card">
        <h3>Posts by Date</h3>
        <a href="AI_learning_2023_02_feb.html">
          AI_learning_2023_02_feb.html</a><br>
        <a href="AI_learning_2023_03_mar.html">
          AI_learning_2023_03_mar.html</a><br>
        <br>
      </div>

      <div class="card">
        <h3>Follow Me</h3>
        <a href="https://discord.gg/F7KQySEW"><img src="../../images/discord.png" alt="discord" height="30"></a>
      </div>

    </div>



  </div>


  <div class="footer">
    <h3>Modified July 2023</h3>
  </div>
</body>

</html>