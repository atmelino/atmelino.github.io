<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" href="../../css/blog.css" media="all" rel="stylesheet">
  <title>atmelino</title>

</head>

<body>

  <div class="header">
    <table id="headerline_table">
      <tr>
        <td width="200">
          <a href="../../index.html"><img src="../../images/home.png" alt="home" height="60"></a>
          <a href="../../blogs/index.html"><img src="../../images/scroll.png" alt="scroll" height="60"></a>
          <a href="../../blogs/cncjs_autolevel/index.html"><img src="../../images/cncjs.png" alt="deno" height="60"></a>
        </td>
        <td>
          <h2>cncjs autolevel widget blog December 2022</h2>
        </td>
      </tr>
    </table>
  </div>

  <div class="row">
    <div class="leftcolumn">

      <div class="card">
        <div id="Table of Contents1" dir="ltr">
          <div id="Table of Contents1_Head" dir="ltr">
            <p style="line-height: 100%; margin-top: 0.17in; margin-bottom: 0.08in; page-break-after: avoid">
              <font face="Liberation Sans, sans-serif">
                <font size="4" style="font-size: 16pt"><b>Table
                    of Contents</b></font>
              </font>
            </p>
          </div>
          <p><a href="#__RefHeading___Toc3171_4290992476">Document
              Revision History 2</a></p>
          <p><a href="#__RefHeading___Toc1743_3051514094">Introduction
              3</a></p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3204_1376189887">Goal 3</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3206_1376189887">Approach 3</a>
          </p>
          <p><a href="#__RefHeading___Toc1745_3051514094">Development
              3</a></p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3208_1376189887">Installation 3</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2773_185379805">GRBL Arduino Serial Port
              Permission 3</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2768_185379805">Autostart cnc.js 4</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2718_2797838048">Building the Project 5</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2720_2797838048">Production version 5</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc1882_3068016539">Configuration 6</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc1887_3068016539">Scripts 6</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc1747_3051514094">Working with git and
              github 7</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3210_1376189887">Methods for outputting
              text for debugging purposes 8</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2499_3471171846">Server Side 8</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2501_3471171846">Client Side 9</a>
          </p>
          <p><a href="#__RefHeading___Toc1773_3051514094">Source
              Code Modification 10</a></p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3212_1376189887">Analyzing Program
              Structure 10</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2376_399122378">Server Side 10</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2378_399122378">Client Side 11</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2282_761723641">Adding the Autolevel
              widget 12</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2388_399122378">Capture Probing event
              from Serial Port 13</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2687_1346135180">Adding a Dialog for the
              Probing Grid Parameters 14</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2959_288041017">Update web page in
              React 14</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3218_1376189887">Display messages that
              are stored in G-Code 15</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3220_1376189887">Have to click Resume
              several times for one G-Code Line 15</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3040_1216396130">Trigger loading g-code
              programmatically 16</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2907_4268615812">G-Code Simulator
              CAMotics 17</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2961_288041017">3d Plot with SciDAVis 17</a>
          </p>
          <p><a href="#__RefHeading___Toc1771_3051514094">Observations
              18</a></p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2390_399122378">2018-10-30 18</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2392_399122378">2018-11-06 18</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2380_399122378">2018 18</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2394_399122378">Passing Data from Grbl
              Controller to Autolevel Widget 18</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3216_1376189887">Serial port Data
              Parsing and sending probe data to the widget 21</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc1889_3068016539">2020-02-03 23</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc1891_3068016539">2020-02-04 25</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc1890_1586111487">2020-02-05 25</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2284_761723641">2020-02-09 26</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2356_4157620613">2020-02-10 26</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2382_399122378">2020-02-12 27</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.39in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc2511_3471171846">2020-02-13 28</a>
          </p>
          <p style="line-height: 100%; margin-left: 0.2in; margin-bottom: 0in">
            <a href="#__RefHeading___Toc3042_1216396130">2020-03-08 29</a>
          </p>
          <p><a href="#__RefHeading___Toc2696_3123084980">References
              31</a></p>
        </div>
        <h2 class="western"><br />
          <br />

        </h2>
        <h1 class="western" style="page-break-before: always"><a name="__RefHeading___Toc3171_4290992476"></a>
          Document Revision History</h1>
        <p><br />
          <br />

        </p>
        <table id="plain_table" width="100%" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="17%">
              <p>
                Revision Date</p>
            </td>
            <td width="17%">
              <p>
                Version</p>
            </td>
            <td width="67%">
              <p>
                Description</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="17%">
              <p>
                2020-03-08</p>
            </td>
            <td width="17%">
              <p>
                0.1</p>
            </td>
            <td width="67%">
              <p>
                Initial Version</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="17%">
              <p>
                2022-12-09</p>
            </td>
            <td width="17%">
              <p>
                <br />

              </p>
            </td>
            <td width="67%">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="17%">
              <p>
                <br />

              </p>
            </td>
            <td width="17%">
              <p>
                <br />

              </p>
            </td>
            <td width="67%">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="17%">
              <p>
                <br />

              </p>
            </td>
            <td width="17%">
              <p>
                <br />

              </p>
            </td>
            <td width="67%">
              <p>
                <br />

              </p>
            </td>
          </tr>
        </table>
        <p><br />
          <br />

        </p>
        <h2 class="western"><br />
          <br />

        </h2>
        <h1 class="western" style="page-break-before: always"><a name="__RefHeading___Toc1743_3051514094"></a>
          Introduction</h1>
        <h2 class="western"><a name="__RefHeading___Toc3204_1376189887"></a>Goal</h2>
        <p>modify CNC.JS to
          output the probing results.</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc3206_1376189887"></a>Approach</h2>
        <p>Modify autolevel
          widget to output the measured probe positions.</p>
        <br>
        <h2 class="western"></h2>
        <h1 class="western"><a name="__RefHeading___Toc1745_3051514094"></a>Development</h1>
        <h2 class="western"><a name="__RefHeading___Toc3208_1376189887"></a>Runtime
          Environment Installation</h2>
        <br>
        <p>Install node.js:</p>
        <br>
        <p><a
            href="https://linuxhint.com/ways-install-use-nodejs-ubuntu/">https://linuxhint.com/ways-install-use-nodejs-ubuntu/</a>
        </p>
        <br>
        <p>Use nvm (node
          version manager) to install the latest version</p>
        <br>
        <p>
          <font face="Courier New, monospace">curl
            -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh |
            bash</font>
        </p>
        <br>
        <p>log out and back in
          so that .bash_rc is run</p>
        <br>
        <p>List available
          versions:</p>
        <br>
        <p>
          <font face="Courier New, monospace">nvm
            list-remote</font>
        </p>
        <br>
        <p>Install version 12
          of node:</p>
        <br>
        <p>
          <font face="Courier New, monospace">nvm
            install 12</font>
        </p>
        <br>
        <p>This is the version
          that is listed as the version to use at</p>
        <br>
        <p>
          <font face="Courier New, monospace"><a
              href="https://github.com/cncjs/cncjs#supported-nodejs-versions">https://github.com/cncjs/cncjs#supported-nodejs-versions</a>
          </font>
        </p>
        <br>
        <p>Validate
          installation and list version:</p>
        <br>
        <p>node --version</p>
        <br>
        <p>as of current date:
          v19.2.0</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2773_185379805"></a>GRBL
          Arduino Serial Port Permission</h2>
        <br>
        <p><a href="https://www.arduino.cc/en/Guide/Linux#toc6">https://www.arduino.cc/en/Guide/Linux#toc6</a></p>
        <br>
        <p>
          <font face="Courier New, monospace">sudo
            usermod -a -G dialout user</font>
        </p>
        <br>
        <p>And / or</p>
        <br>
        <p>
          <font face="Courier New, monospace">sudo
            chmod a+rw /dev/ttyACM0</font>
        </p>
        <br>
        <p>logout and login or
          reboot</p>
        <br>
        <h2 class="western">Source Code Installation</h2>
        <br>
        <p>Download curent
          development source code:</p>
        <br>
        <p>
          <font face="Courier New, monospace">git
            clone <a
              href="https://github.com/atmelino/cncjs_1_10_0_AL.git">https://github.com/atmelino/cncjs_1_10_0_AL.git</a>
          </font>
        </p>
        <br>
        <p>The github
          repository does not contain all the node modules required, because of
          the size and number of files. In its current state, the source code
          size is about 66 Mbytes.</p>
        <br>
        <p>Install node
          dependencies:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            install</font>
        </p>
        <br>
        <p>The file
          package.json contains a list of the required modules as well as
          commands that can be run.</p>
        <br>
        <h2 class="western">Build Process</h2>
        <br>
        <p>In the root of the
          project, run</p>
        <p>npm run build-prod</p>
        <br>
        <p>at the new version,
          this leads to error
        </p>
        <p>events.js:160</p>
        <p> throw er; //
          Unhandled 'error' event</p>
        <p> ^</p>
        <p>Error: This socket
          has been ended by the other party</p>
        <br>
        <p>In that case, build
          van be completed sucessfully by building parts separately.</p>
        <br>
        <p>The build-prod
          script stands for</p>
        <p>&quot;build-prod&quot;:
          &quot;concurrently --kill-others-on-fail --names
          \&quot;build-prod-app,build-prod-web\&quot; \&quot;npm run
          build-prod-app\&quot; \&quot;npm run build-prod-web\&quot;&quot;,</p>
        <br>
        <p>Instead of running
          build-prod, first run</p>
        <p>
          <font face="Courier New, monospace">npm
            run build-prod-app</font>
        </p>
        <br>
        <p>when it is finished,
          run</p>
        <p>
          <font face="Courier New, monospace">npm
            run build-prod-web</font>
        </p>
        <br><br>
        <p style="line-height: 100%; margin-bottom: 0in; page-break-before: always">
          <br />

        </p>
        <br>
        <p>From Previous doc:</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2768_185379805"></a>Autostart
          cnc.js</h2>
        <br>
        <p>Create a service for
          autostart:</p>
        <br>
        <p>
          <font face="Courier New, monospace">sudo
            nano /etc/systemd/system/cncjs.service</font>
        </p>
        <br>
        <p>and enter</p>
        <br>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">[Unit]</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">Description=cncjs
              application</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">Documentation=https://github.com/atmelino/cncjs</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">After=network.target</font>
          </font>
        </p>
        <br>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">[Service]</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">Environment=NODE_PORT=3002</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">Type=simple</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">User=root</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">WorkingDirectory=/media/data/github/cncjs</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">ExecStart=/usr/local/n/versions/node/12.16.1/bin/node
              /media/data/github/cncjs_1_10_0_AL/bin/cncjs</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">Restart=on-failure</font>
          </font>
        </p>
        <br>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">[Install]</font>
          </font>
        </p>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 11pt">WantedBy=multi-user.target</font>
          </font>
        </p>
        <br>
        <p>to start the
          service:</p>
        <br>
        <p>
          <font face="Courier New, monospace">sudo
            systemctl start cncjs</font>
        </p>
        <br>
        <p>to stop the service:</p>
        <br>
        <p>
          <font face="Courier New, monospace">sudo
            systemctl stop cncjs</font>
        </p>
        <br>
        <p>make sure it starts
          every time system boots:</p>
        <br>
        <p>
          <font face="Courier New, monospace">sudo
            systemctl enable cncjs</font>
        </p>
        <br>
        <p>To get the status of
          the Dropbox service:</p>
        <br>
        <p>
          <font face="Courier New, monospace">systemctl
            status cncjs</font>
        </p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2718_2797838048"></a>Building
          the Project</h2>
        <br>
        <p>Download original
          source code:</p>
        <br>
        <p>
          <font face="Courier New, monospace">git
            clone <a href="https://github.com/cncjs/cncjs.git">https://github.com/cncjs/cncjs.git</a></font>
        </p>
        <br>
        <p>The follwing command
          will build the project and start the server:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run dev</font>
        </p>
        <br>
        <p>When changes are
          made to the source code, the changes are automatically updated in the
          running application.</p>
        <br>
        <p>Run the client:</p>
        <br>
        <p>Open a web browser
          and go to the URL</p>
        <br>
        <p>
          <font face="Courier New, monospace">http://127.0.1.1:8000</font>
        </p>
        <br>
        <p>Just check for
          syntax errors:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run eslint</font>
        </p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2720_2797838048"></a>Production
          version</h2>
        <p>- For production:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-latest</font>
        </p>
        <br>
        <p>Run the server:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            start</font>
        </p>
        <br>
        <p>Run the client:</p>
        <br>
        <p>Open a web browser
          and go to the URL</p>
        <br>
        <p>
          <font face="Courier New, monospace">http://127.0.1.1:8000</font>
        </p>
        <br>
        <p>Test: Installation
          on a new computer</p>
        <br>
        <p>- install npm by
          sudo apt install npm</p>
        <p>- npm update</p>
        <p>- download zip from
          cnc.js github</p>
        <p>- extract</p>
        <p>- cd cncjs-master/</p>
        <p>- npm run
          build-latest</p>
        <p>- npm start</p>
        <br>
        <p>works!</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc1882_3068016539"></a>Configuration</h2>
        <p>Settings are stored
          in the file
        </p>
        <p>
          <font face="Courier New, monospace">package.json</font>
        </p>
        <br>
        <p>Different
          directories can have their own</p>
        <p>
          <font face="Courier New, monospace">package.json</font>
        </p>
        <br>
        <p>To prevent certain
          code issues from causing an error in building, edit
        </p>
        <p>
          <font face="Courier New, monospace">./.eslintrc.js</font>
        </p>
        <br>
        <p>and add</p>
        <br>
        <p>
          <font face="Courier New, monospace">&quot;rules&quot;:
            {</font>
        </p>
        <p>
          <font face="Courier New, monospace">&quot;lines-between-class-members&quot;:
            &quot;off&quot;,</font>
        </p>
        <p>
          <font face="Courier New, monospace">&quot;no-unused-vars&quot;:
            &quot;off&quot;,</font>
        </p>
        <p>
          <font face="Courier New, monospace">&quot;max-lines-per-function&quot;:
            &quot;off&quot;,</font>
        </p>
        <p>
          <font face="Courier New, monospace">}</font>
        </p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc1887_3068016539"></a>Scripts</h2>
        <p>The source code
          repository has a script folder.</p>
        <p>In the script
          folder, there is a file named prebuild-prod.sh.</p>
        <p>In prebuild-prod.sh,
          trhere is a line &quot;mkdir -p ../dist/cnc/&quot;</p>
        <br>
        <p>To use the scripts,
          we need babel:</p>
        <p>npm install -g
          babel-cli</p>
        <br>
        <p>scripts/prebuild-prod.sh
        </p>
        <p>leads to the
          creation of dist/cnc/electron-app but not dist/cnc/web</p>
        <br>
        <p>However,
          package.json contains a script section. In this file is a number of
          build commands, some of which refer to a web folder.</p>
        <br>
        <p>The command
        </p>
        <p>npm run
          build-prod-web</p>
        <p>will create the
          desired web folder.</p>
        <br>
        <h2 class="western"></h2>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc1747_3051514094"></a>Working
          with git and github</h2>
        <br>
        <p>Getting whole
          repository from github:</p>
        <p>git clone
          <a href="https://github.com/atmelino/cncjs.git">https://github.com/atmelino/cncjs.git</a>
        </p>
        <br>
        <p>Getting new changes
          from github:</p>
        <p>git pull</p>
        <br>
        <p>Sending new changes
          to github:</p>
        <p>if new files:</p>
        <p>git add (name of
          file or folder)</p>
        <br>
        <p>git commit -a</p>
        <p>git push origin
          master</p>
        <br>
        <h2 class="western" style="page-break-before: always"><a name="__RefHeading___Toc3210_1376189887"></a>
          Methods for outputting text for debugging purposes</h2>
        <br>
        <h3 class="western"><a name="__RefHeading___Toc2499_3471171846"></a>Server
          Side</h3>
        <p>Messages from the server side will be shown in the terminal in
          which we run</p>
        <p>
          <font face="Courier New, monospace">npm start</font>
        </p>
        <p>The file in which we
          log must have the import</p>
        <br>
        <p>
          <font face="Courier New, monospace">import
            logger from '../../lib/logger';</font>
        </p>
        <br>
        <p>This logging system
          has several verbosity levels:</p>
        <br>
        <table id="plain_table" width="100%" cellpadding="5" cellspacing="0">
          <tr valign="top">
            <td width="50%">
              <p>
                <i>Name</i>
              </p>
            </td>
            <td width="50%">
              <p>
                <i>Program start parameter</i>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <p>
                verbose</p>
            </td>
            <td width="50%">
              <p>
                v</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <p>
                debug</p>
            </td>
            <td width="50%">
              <p>
                vv</p>
            </td>
          </tr>
          <tr valign="top">
            <td width="50%">
              <p>
                silly</p>
            </td>
            <td width="50%">
              <p>
                vvv</p>
            </td>
          </tr>
        </table>
        <br>
        <p>For example, if we
          start the server with the parameter vvv then this will print a
          message:</p>
        <br>
        <p>run</p>
        <br>
        <p>
          <font face="Courier New, monospace">node
            bin/cncjs -vvv</font>
        </p>
        <br>
        <p>Edit file</p>
        <br>
        <p>
          <font face="Courier New, monospace">GrblController.js</font>
        </p>
        <p>
          <font face="Courier New, monospace">52:
            log.silly('hello hello !!!');</font>
        </p>
        <p>and start in vvv
          level</p>
        <br>
        <p>Alternatively, we
          could add the line</p>
        <br>
        <p>
          <font face="Courier New, monospace">&quot;start-vvv&quot;:
            &quot;./bin/cnc -vvv&quot;,</font>
        </p>
        <br>
        <p>in the scripts
          section of package.json</p>
        <p>and start with</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run start-vvv</font>
        </p>
        <br>
        <p>the function
          log.error will output in the terminal at the lowest and any verbosity
          level.</p>
        <br>
        <h3 class="western"><br />
          <br />

        </h3>
        <h3 class="western" style="page-break-before: always"><a name="__RefHeading___Toc2501_3471171846"></a>
          Client Side</h3>
        <p>Messages from the client side will be shown in the web browser in
          which we open the console panel</p>
        <p>In Chrome, we open
          the console panel with CRTL-SHIFT-J</p>
        <br>
        <p>The file in which we
          log must have the imports</p>
        <br>
        <p>
          <font face="Courier New, monospace">import
            { TRACE, DEBUG, INFO, WARN, ERROR } from 'universal-logger';</font>
        </p>
        <p>
          <font face="Courier New, monospace">import
            log from '../../lib/log';</font>
        </p>
        <br>
        <p>Example:</p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="57">
              <p>
                <br />

              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Macro/index.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">11</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">import log from
                  '../../lib/log';</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">70</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">log.error('full
                  screen toggled');</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>In addition, cncjs
          has a console widget and in this we can print debug messages</p>
        <br>
        <p>File:</p>
        <p>src/web/widgets/Console/index.jsx</p>
        <p>103:
          this.terminal.writeln('hello');</p>
        <br>
        <p>File:</p>
        <p>GrblController.js</p>
        <p>492:
          this.emit('serialport:read', `test ALARM:${code}
          (${alarm.message})`);</p>
        <p>shows up in console</p>
        <br>
        <p>shows up in browser
          console</p>
        <br>
        <h2 class="western"><br />
          <br />

        </h2>
        <h1 class="western" style="page-break-before: always"><a name="__RefHeading___Toc1773_3051514094"></a>
          Source Code Modification</h1>
        <h2 class="western"><a name="__RefHeading___Toc3212_1376189887"></a>Analyzing
          Program Structure</h2>
        <h3 class="western"><a name="__RefHeading___Toc2376_399122378"></a>Server
          Side</h3>
        <br>
        <p>The command</p>
        <p>
          <font face="Courier New, monospace">npm
            start</font>
        </p>
        <p>looks into the file</p>
        <p>
          <font face="Courier New, monospace">.</font>
          <font face="Courier New, monospace">/</font>
          <font face="Courier New, monospace">package.json</font>
        </p>
        <p>In this file is a
          scripts section with</p>
        <p>
          <font face="Courier New, monospace">&quot;scripts&quot;:
            {</font>
        </p>
        <p>
          <font face="Courier New, monospace"> ..</font>
        </p>
        <p>
          <font face="Courier New, monospace"> &quot;start&quot;:
            &quot;./bin/cncjs&quot;,</font>
        </p>
        <p>
          <font face="Courier New, monospace"> ..</font>
        </p>
        <p>
          <font face="Courier New, monospace">}</font>
        </p>
        <p>It is also possible
          to start the server by typing</p>
        <p>
          <font face="Courier New, monospace">node
            bin/cncjs</font>
        </p>
        <br>
        <p>In the file</p>
        <p>
          <font face="Courier New, monospace">./bin/cncjs</font>
        </p>
        <p>the function</p>
        <p>
          <font face="Courier New, monospace">default()</font>
        </p>
        <p>is called from the
          file</p>
        <p>
          <font face="Courier New, monospace">./dist/cncjs/server-cli.js</font>
        </p>
        <br>
        <p>This function calls
          the function</p>
        <p>
          <font face="Courier New, monospace">createServer()</font>
        </p>
        <p>in the file</p>
        <p>
          <font face="Courier New, monospace">./dist/server/index.js</font>
        </p>
        <br>
        <p>Unknown: somehow,
        </p>
        <p>./src/server/services/cncengine/CNCEngine.js</p>
        <p>is started and it
          starts</p>
        <p>./src/server/controllers/Grbl/GrblController.js</p>
        <br>
        <p>Inside the class
          GrblController</p>
        <p>the constructor sets
          up
        </p>
        <ul>
          <li>
            <p>this.feeder and
              this.feeder.on events</p>
          <li>
            <p>this.sender and
              this.sender.on events</p>
          <li>
            <p>this.workflow
              and this.workflow.on events</p>
          <li>
            <p>this.runner and
              this.runner.on events</p>
        </ul>
        <br>
        <p>The follwing is from
          previous doc, needs to be reworked</p>
        <br>
        <p><i>the server is
            created in </i>
        </p>
        <p><i>nodeDevelop/cncjs-autolevel/src/app/index.js</i></p>
        <p><i>const
            createServer = (options, callback) =&gt; {</i></p>
        <br>
        <p><i>There is a
            function const appMain = () =&gt; { </i>
        </p>
        <p><i>in </i>
        </p>
        <p><i>nodeDevelop/cncjs-autolevel/src/app/app.js</i></p>
        <p><i>If I delete it
            and run</i></p>
        <p><i>npm run prepare</i></p>
        <p><i>I get error</i></p>
        <p><i>nodeDevelop/cncjs-autolevel/src/app/index.js</i></p>
        <p> <i>18:17 error
            Unable to resolve path to module './app' import/no-unresolved</i></p>
        <br>
        <h3 class="western"><a name="__RefHeading___Toc2378_399122378"></a>Client
          Side</h3>
        <br>
        <p>The framework used
          causes the initial page to be loaded from</p>
        <p>
          <font face="Courier New, monospace">./dist/app/index.hbs</font>
        </p>
        <p>in this file, a
          javascript source is loaded at</p>
        <p>
          <font face="Courier New, monospace">app.e2134974ba17dc978fbd.bundle.js</font>
        </p>
        <p>This is the actual
          web page.</p>
        <br>
        <p>Sources:</p>
        <br>
        <p>The file</p>
        <p>
          <font face="Courier New, monospace">./dist/app/index.hbs</font>
        </p>
        <p>is built from the
          source at</p>
        <p>
          <font face="Courier New, monospace">./dist/src/index.jsx</font>
        </p>
        <br>
        <h2 class="western" style="page-break-before: always"><a name="__RefHeading___Toc2282_761723641"></a>
          Adding the Autolevel widget</h2>
        <p>One approach is to clone a widget, such as laser as laser2, and
          then compile the code and see if it still runs. If it runs, modify it
          and restore previous source code state if run time error occurs.
        </p>
        <p><br />
          <br />

        </p>
        <p>The file</p>
        <p>
          <font face="Courier New, monospace">./src/app/containers/Workspace/WidgetManager/WidgetManager.jsx</font>
        </p>
        <br>
        <p>contains the
          variable widgetList. Adding an item will result in the item being
          offered as an option.</p>
        <br>
        <p>
          <img src="images/devNotes_html_6e8665d1739d5c04.png" name="Image2" align="bottom" width="444" height="50"
            border="0" />
        </p>
        <br>
        <p><img src="images/devNotes_html_9491aaac53fe8adc.png" name="Image3" align="bottom" width="831" height="602"
            border="0" />
        </p>
        <br>
        <h2 class="western"></h2>
        <p><br />
          <br />

        </p>
        <p><br />
          <br />

        </p>
        <p><br />
          <br />

        </p>
        <p>The new widget also needs to be added to the file</p>
        <p>
          <font face="Courier New, monospace">./src/app/containers/Workspace/Widget.jsx</font>
        </p>
        <p><br />
          <br />

        </p>
        <p>the default state needs to be added to</p>
        <p>
          <font face="Courier New, monospace">src/app/store/defaultState.js</font>
        </p>
        <p>Finally we need to add a folder named</p>
        <p>
          <font face="Courier New, monospace">./src/app/widgets/ProbingGrid</font>
        </p>
        <p>containing the files</p>
        <p>
          <font face="Courier New, monospace">index.jsx index.styl
            ProbingGrid.jsx react-table.css</font>
        </p>
        <p>Probing grid uses additional modules which need to be installed:</p>
        <p>
          <font face="Courier New, monospace">npm
            i react-table</font>
        </p>
        <p>
          <font face="Courier New, monospace">npm
            i numeral</font>
        </p>
        <p><br />
          <br />

        </p>
        <p><br />
          <br />

        </p>
        <p><br />
          <br />

        </p>
        <h2 class="western"><a name="__RefHeading___Toc2388_399122378"></a>Capture
          Probing event from Serial Port</h2>
        <p><br />
          <br />

        </p>
        <p>When a probing command is sent to the GRBL controller through the
          serial port, the machine will start probing, and when contact is
          made, the GRBL controller will send throug the serial port data such
          as</p>
        <p>
          <font face="Courier New, monospace">[PRB:0.000,0.000,7.404:1]</font>
        </p>
        <p>We want to capture these data and send them to the widget.</p>
        <p>In the file
        </p>
        <p>
          <font face="Courier New, monospace">./src/server/controllers/Grbl/GrblController.js</font>
        </p>
        <p>replace</p>
        <p>
          <font face="Courier New, monospace">this.runner.on('parameters',
            (res) =&gt; {</font>
        </p>
        <p>
          <font face="Courier New, monospace">this.emit('serialport:read',
            res.raw);</font>
        </p>
        <p>
          <font face="Courier New, monospace">});</font>
        </p>
        <p><br />
          <br />

        </p>
        <br>
        <p>with</p>
        <br>
        <p>
          this.runner.on('parameters', (res) =&gt; {</p>
        <p> //
          atmelino</p>
        <p>
          log.error('parameters: ' + JSON.stringify(res));</p>
        <p> const
          probingData = {</p>
        <p>
          type: 'probing',</p>
        <p>
          printed: false,</p>
        <p>
          result: res.value</p>
        <p> };</p>
        <p>
          //this.emit('serialport:read', 'parameters');</p>
        <p>
          this.emit('serialport:read', probingData);</p>
        <p>
          this.emit('serialport:read', res.raw);</p>
        <p> });</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2687_1346135180"></a>Adding
          a Dialog for the Probing Grid Parameters</h2>
        <br>
        <p>The Probe widget and
          the Macro widget have dialogs, for reference.</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2959_288041017"></a>Update
          web page in React</h2>
        <br>
        <p>If a component has a
          member of state,</p>
        <br>
        <p>state = {</p>
        <p> mynumber: 9</p>
        <p>}</p>
        <br>
        <p> then calling
        </p>
        <br>
        <p>this.setState({
          mynumber: 2.3 });</p>
        <br>
        <p>will update the web
          page.</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc3218_1376189887"></a>Display
          messages that are stored in G-Code</h2>
        <br>
        <p>2018-11-17</p>
        <br>
        <p>in vvv mode, entire
          line of g-code is printed in terminal</p>
        <br>
        <p>file:</p>
        <p>src/app/controllers/Grbl/GrblController.js</p>
        <br>
        <p>2018-11-18T02:05:59.941Z
          - silly: controller:Grbl &gt; M0 (Attach probe wires and clips that
          need attaching)</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc3220_1376189887"></a>Have
          to click Resume several times for one G-Code Line</h2>
        <br>
        <p>First M0, have to
          click only once:</p>
        <p>2018-11-18T02:51:40.938Z
          - error: controller:Grbl M0 Program Pause in Sender</p>
        <p>2018-11-18T02:51:40.941Z
          - error: controller:Grbl GbrController.js this.sender.onM0 (Attach
          probe wires and clips that need attaching)</p>
        <br>
        <p>Second M0, have to
          click twice:</p>
        <p>2018-11-18T02:53:49.224Z
          - error: controller:Grbl M0 Program Pause in Sender</p>
        <p>2018-11-18T02:53:52.597Z
          - error: controller:Grbl2 Grbl.js: prb found</p>
        <p>2018-11-18T02:53:52.598Z
          - error: controller:Grbl2 Grbl.js: GrblLineParserResultParameters
          parameters emit</p>
        <p>2018-11-18T02:53:52.599Z
          - error: controller:Grbl
          parameters{&quot;name&quot;:&quot;PRB&quot;,&quot;value&quot;:{&quot;result&quot;:1,&quot;x&quot;:&quot;-82.888&quot;,&quot;y&quot;:&quot;-0.048&quot;,&quot;z&quot;:&quot;-2.676&quot;},&quot;raw&quot;:&quot;[PRB:-82.888,-0.048,-2.676:1]&quot;}
        </p>
        <br>
        <p>first click:</p>
        <p>2018-11-18T02:54:30.947Z
          - error: controller:Grbl M0 Program Pause in Sender</p>
        <p>2018-11-18T02:54:30.948Z
          - error: controller:Grbl GbrController.js this.sender.onM0 (Detach
          any clips used for probing)</p>
        <br>
        <p>needs second click!</p>
        <br>
        <p>Maybe because of the
          probing G38.2?</p>
        <br>
        <p>Observation:</p>
        <br>
        <p>if there is one
          G38.2 command before the M0 command, there is only one click to
          continue.</p>
        <p>if there are teo
          G38.2 commands before the M0 command, there are two clicks to
          continue!</p>
        <br>
        <table id="plain_table" width="100%" cellpadding="0" cellspacing="0">

          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">G38.2 Z-1 F100 (Probe to a
                  maximum of the specified probe height at the specified feed rate)</font>
              </p>
            </td>
          </tr>
          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">G92 Z0 (Touch off Z to 0 once
                  contact is made)</font>
              </p>
            </td>
          </tr>
          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">G0 Z2 (Move Z to above the
                  contact point)</font>
              </p>
            </td>
          </tr>
          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">G38.2 Z-1 F50 (Repeat at a
                  more accurate slower rate)</font>
              </p>
            </td>
          </tr>
          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">G92 Z0</font>
              </p>
            </td>
          </tr>
          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">G0 Z2</font>
              </p>
            </td>
          </tr>
          <tr>
            <td width="100%" valign="top" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">M0 (Detach any clips used for
                  probing)</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc3040_1216396130"></a>Trigger
          loading g-code programmatically</h2>
        <br>
        <p>If a gcode file is
          loaded and I press reload in the browser, the same gcode file is
          automatically loaded so there is probably another way to initiate
          loading other than clicking the Upload G-Code button in the
          Visualizer.</p>
        <br>
        <p>Daog and dropping a
          gcode file into the web browser window causes the function</p>
        <p>onDrop</p>
        <p>in the file</p>
        <p>Workspace.jsx</p>
        <p>to be called.</p>
        <br>
        <p>The function call</p>
        <p>
          api.loadGCode({ port, name, gcode })</p>
        <p>in the function
          onDrop works.</p>
        <br>
        <p style="line-height: 100%; margin-bottom: 0in; page-break-before: always">
          <br />

        </p>
        <h2 class="western"><a name="__RefHeading___Toc2907_4268615812"></a>G-Code
          Simulator CAMotics</h2>
        <br>
        <p>CAMotics</p>
        <br>
        <p>Download deb file
          and install</p>
        <br>
        <p>Fix missing library
          error by</p>
        <br>
        <p>sudo apt-get install
          libqt5websockets5-dev</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2961_288041017"></a>3d
          Plot with SciDAVis</h2>
        <br>
        <p>Create data in
          Libreoffice Calc</p>
        <br>
        <p>export as csv</p>
        <br>
        <p>import in SciDAVis</p>
        <br>
        <p>convert to matrix</p>
        <br>
        <p>enter column and row
          coordinates</p>
        <br>
        <p>make 3D Plot</p>
        <br>
        <h1 class="western" style="page-break-before: always"><a name="__RefHeading___Toc1771_3051514094"></a>
          Observations</h1>
        <h3 class="western"><a name="__RefHeading___Toc2390_399122378"></a>2018-10-30</h3>
        <p>Cloned another
          widget and named it Autoleveller.</p>
        <br>
        <p>removed Start-Y
          section from ./src/web/widgets/Autoleveller/Autoleveller.jsx</p>
        <p>and it shows up
          accordingly on web page</p>
        <br>
        <h3 class="western"><a name="__RefHeading___Toc2392_399122378"></a>2018-11-06</h3>
        <p>the code for GRBL
          controller communication appears to be in
        </p>
        <p>cncjs-autolevel/src/app/controllers/Grbl/GrblController.js</p>
        <p>here a class named
          GrblController is defined.
        </p>
        <p>It contains a
          variable named controller which is of type Grbl</p>
        <p>38:
          this.controller = new Grbl();</p>
        <br>
        <p>Grbl is defined in
        </p>
        <p>cncjs-autolevel/src/app/controllers/Grbl/Grbl.js</p>
        <p>588: class Grbl
          extends events.EventEmitter {</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2380_399122378"></a>2018</h2>
        <p><br />
          <br />

        </p>
        <h3 class="western"><a name="__RefHeading___Toc2394_399122378"></a>Passing
          Data from Grbl Controller to Autolevel Widget</h3>
        <br>
        <p>There are several
          widgets that receive data from GrblController.js, for example the
          Axes widget.</p>
        <p>How are the data
          sent from the GRBL controller to the widget?</p>
        <br>
        <p>In
          src/web/widgets/Axes/DisplayPanel.jsx</p>
        <p>there is a
        </p>
        <p>class DisplayPanel
          extends PureComponent {</p>
        <p>and a render
          function.</p>
        <br>
        <p>we have a variable
          named machinePosition</p>
        <p>it gets it's value
          from</p>
        <p>
        </p>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Axes/DisplayPanel.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">const { state, actions } =
                  this.props;</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">const { units, canClick, axes,
                  machinePosition, workPosition } = state;</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>so props are used to
          pass data into the widget which is a React component.</p>
        <br>
        <p>Working backwards
          from the component:</p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Axes/DisplayPanel.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">35</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">render() {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">52</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">return (</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">210</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">&lt;span
                  className={styles.integerPart}&gt;</font>
              </p>
              <p>
                <font face="Courier New, monospace">{machinePosition.x.split('.')[0]}&lt;/span&gt;</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>The value of
          machinePosition is used to display in the axes widget</p>
        <br>
        <p><img src="images/devNotes_html_c431bc0e7ec021c9.png" name="Image1" align="bottom" width="399" height="91"
            border="0" />
        </p>
        <br>
        <p>the value of
          machinePosition is assigned from this.props</p>
        <br>
        <p>DisplayPanel is
          instantiated in
        </p>
        <br>
        <table id="plain_table" width="831" cellpadding="0" cellspacing="0">

          <tr valign="top">
            <td width="68" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="764" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Axes/Axes.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="68" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="764" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">const
                  Axes = (props) =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="68" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="764" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">const
                  { config, state, actions } = props;</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="68" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="764" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">return
                  (</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="68" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="764" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">&lt;div&gt;</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="68" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="764" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">&lt;DisplayPanel
                  config={config} state={state} actions={actions} /&gt;</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>so DisplayPanel
          receives its props from Axes, Axes passes the props down to
          DisplayPanel.</p>
        <br>
        <p>Axes is instantiated
          in
        </p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">
          <tr valign="top">
            <td width="57">
              <p>
                <br />

              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Axes/index.jsx
                </font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">87</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">class AxesWidget extends
                  PureComponent {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">686</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">render() {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">811</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">&lt;Axes config={config}
                  state={state} actions={actions} /&gt;</font>
              </p>
            </td>
          </tr>
        </table>
        <p>
        </p>
        <p>It seems like this
          calls is added to the listeners of the controller. Could this be the
          connection to the Grbl data received from the serial port?</p>
        <br>
        <p>The function
          controllerEvents() is added to the listeners of the controller:</p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">
          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Axes/index.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">528</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">componentDidMount() {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">529</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">this.addControllerEvents();</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">596</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">addControllerEvents() {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">597</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">Object.keys(this.controllerEvents).forEach(eventName
                  =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">598</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">const callback =
                  this.controllerEvents[eventName];</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">599</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">controller.addListener(eventName,
                  callback);</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>And in the function
          controllerEvents() , the variable machinePosition is assigned a value
          from the state
        </p>
        <p>(coming from the
          controller ?)</p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Axes/index.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">324</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">controllerEvents = {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">355</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">'controller:state':
                  (type, controllerState) =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">416</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">this.setState(state =&gt; ({</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">417</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">units: units,</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">418</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">controller:
                  {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">419</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">...state.controller,</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">420</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">type:
                  type,</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">421</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">state:
                  controllerState</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">machinePosition:
                  mapValues({</font>
              </p>
              <p>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">...state.machinePosition,</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
        </table>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">src/app/controllers/Grbl/GrblController.js</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <font face="Courier New, monospace">662</font>
              </p>
            </td>
            <td width="745">
              <p>
                <font face="Courier New, monospace">this.emit('controller:state',
                  GRBL, this.state);</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="64">
              <p>
                <br />

              </p>
            </td>
            <td width="745">
              <p>
                <br />

              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>Added line to
          GrblController.js</p>
        <p>664:
          log.error('GrblController.js Grbl state');</p>
        <p>and it shows up in
          the terminal.</p>
        <p>Especially, it shows
          up when probe command is issued.</p>
        <p>The command
        </p>
        <p>
          log.error('' + JSON.stringify(this.state));</p>
        <p>prints all the
          values in the state.</p>
        <br>
        <p>Autoleveller widget
          does not have the controller:state case in controller events.</p>
        <p>Perhaps it would be
          better to clone a different widget for probing output?</p>
        <br>
        <p>Laser seems like a
          good candidate because it has addListener and controller:state</p>
        <br>
        <p>Added log output to
        </p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="57">
              <p>
                <br />

              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Laser/index.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">11</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">import log from
                  '../../lib/log';</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <br />

              </p>
            </td>
            <td width="753">
              <p>
                <br />

              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">117</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">log.error('laser
                  lasertest:on');</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">123</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">controllerEvents = {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">141</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">'controller:state':
                  (type, controllerState) =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="57">
              <p>
                <font face="Courier New, monospace">149</font>
              </p>
            </td>
            <td width="753">
              <p>
                <font face="Courier New, monospace">log.error('laser
                  controller:state');</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>Lasertest info
          output works (in browser console)</p>
        <br>
        <p>laser controller
          state also works.</p>
        <br>
        <p><br />
          <br />

        </p>
        <p><br />
          <br />

        </p>
        <h3 class="western"><a name="__RefHeading___Toc3216_1376189887"></a>Serial
          port Data Parsing and sending probe data to the widget</h3>
        <br>
        <p>Where does the
          parsing of serial port data received take place?</p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">src/app/controllers/Grbl/GrblLineParserResultParameters.js</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">395</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">class
                  GrblLineParserResultParameters {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">396</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">static parse(line) {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">426</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">if (name === 'PRB') {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">428</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">log.error('prb
                  found');</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>Leads to output in
          terminal</p>
        <p>2018-11-14T01:32:31.631Z
          - error: controller:Grbl2 prb found</p>
        <br>
        <p>how can we send the
          result to the widget?</p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">src/app/controllers/Grbl/GrblRunner.js</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">718</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">if (type ===
                  GrblLineParserResultParameters) {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">730</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">log.error('Grbl.js:
                  GrblLineParserResultParameters parameters emit');</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">731</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">this.emit('parameters',
                  payload);</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>Leads to</p>
        <p>2018-11-14T02:07:02.325Z
          - error: controller:Grbl2 Grbl.js: GrblLineParserResultParameters
          parameters emit</p>
        <br>
        <p>but
        </p>
        <br>
        <table id="plain_table" width="831" cellpadding="5" cellspacing="0">

          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Autoleveller/index.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <font face="Courier New, monospace">71</font>
              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">controllerEvents = {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">'parameters':
                  (payload) =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="49">
              <p>
                <br />

              </p>
            </td>
            <td width="760">
              <p>
                <font face="Courier New, monospace">log.error('Autolevel
                  Probing PRB');</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>Does not show in
          browser console.</p>
        <br>
        <p>Note: in order to
          print state values in console, need to make sure that they already
          exist
        </p>
        <br>
        <p>
          <font face="Courier New, monospace">if
            (Object.prototype.hasOwnProperty.call(state, 'machinePosition')) {</font>
        </p>
        <br>
        <p>To learn about
          controller, emit, addListener</p>
        <p>google controller
          emit addlistener</p>
        <br>
        <p>Temporary Solution:</p>
        <br>
        <table id="plain_table" width="831" cellpadding="0" cellspacing="0">

          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">src/app/controllers/Grbl/GrblController.js</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">this.controller.on('parameters',
                  (res) =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">const myobj = {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">type: 'probing',</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">printed: false,</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">res: res</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">};</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">this.emit('serialport:read',
                  myobj);</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">// my debug</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">log.error('parameters' +
                  JSON.stringify(res));</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">this.emit('prbevent',
                  res.raw);</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">});</font>
              </p>
            </td>
          </tr>
        </table>
        <p>And on the receiving
          side:</p>
        <br>
        <table id="plain_table" width="831" cellpadding="0" cellspacing="0">

          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">src/web/widgets/Autoleveller/index.jsx</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">controllerEvents = {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">'serialport:read': (received)
                  =&gt; {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">if (received.type ===
                  'probing') {</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">// atmelino</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">log.error('Autolevel probing
                  received through serialport:read');</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">this.setState({ myvals:
                  received });</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">}</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">const { opt } = received;</font>
              </p>
            </td>
          </tr>
          <tr valign="top">
            <td width="60" style="border: none; padding: 0in">
              <p><br />

              </p>
            </td>
            <td width="771" style="border: none; padding: 0in">
              <p>
                <font face="Courier New, monospace">},</font>
              </p>
            </td>
          </tr>
        </table>
        <br>
        <p>It would be better
          to have its own event for this rather than using serialport:read, but
          I have tried and the event was not received.</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc1889_3068016539"></a>2020-02-03</h2>
        <br>
        <p>1. location of
          transpiled code</p>
        <br>
        <p>When I delete the
          folder <font face="Courier New, monospace">./dist/cnc</font>
          <font face="Courier New, monospace">js
          </font>, then
        </p>
        <p>
          <font face="Courier New, monospace">npm
            start</font>
        </p>
        <p>causes an error.</p>
        <br>
        <p>
          <font face="Courier New, monospace">Error:
            Cannot find module '../dist/cncjs/server-cli'</font>
        </p>
        <br>
        <p>When I run</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-prod-server</font>
        </p>
        <p>
          <font face="Courier New, monospace">npm
            run build-latest</font>
        </p>
        <br>
        <p>then the folder is
          recreated and
        </p>
        <p>
          <font face="Courier New, monospace">npm
            start</font>
        </p>
        <p>works again.</p>
        <br>
        <p>2.</p>
        <br>
        <p>When I change the
          version line in
        </p>
        <p>
          <font face="Courier New, monospace">./</font>
          <font face="Courier New, monospace">src/</font>
          <font face="Courier New, monospace">package.json</font>
        </p>
        <p>from</p>
        <p>&quot;version&quot;:
          &quot;1.10.0-latest&quot;</p>
        <p>to</p>
        <p>&quot;version&quot;:
          &quot;1.10.0-atmelino&quot;,</p>
        <br>
        <p>and restart
        </p>
        <p>
          <font face="Courier New, monospace">npm
            start</font>
        </p>
        <p>the version text in
          the web browser is not changed.</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-prod-server</font>
        </p>
        <p>does not cause the
          change to be reflected.</p>
        <br>
        <p>The text
          &quot;1.10.0-latest&quot; is still in the files
        </p>
        <p>
          <font face="Courier New, monospace">./dist/cncjs/package.json</font>
        </p>
        <p>and</p>
        <p>./dist/cncjs/app/vendor.c96e7fe8b2de493a9c69.bundle.js</p>
        <p>and</p>
        <p>
          /media/data/nodeDevelop/cncjs/dist/cncjs/app/app.e9fff98e88ba50bf3081.bundle.js</p>
        <br>
        <p>Running
        </p>
        <p>
          <font face="Courier New, monospace">npm
            run build-</font>
          <font face="Courier New, monospace">latest</font>
        </p>
        <br>
        <p>changes the text
          back from atmelino to latest!!!</p>
        <br>
        <p>When I change the
          version line in
        </p>
        <p>
          <font face="Courier New, monospace">.</font>
          <font face="Courier New, monospace">/</font>
          <font face="Courier New, monospace">package.json</font>
        </p>
        <p>from</p>
        <p>&quot;version&quot;:
          &quot;1.10.0&quot;</p>
        <p>to</p>
        <p>&quot;version&quot;:
          &quot;2.10.0&quot;,</p>
        <br>
        <p>and run</p>
        <p>
          <font face="Courier New, monospace">npm
            run build</font>
        </p>
        <p>and then</p>
        <p>
          <font face="Courier New, monospace">npm
            start</font>
        </p>
        <p>then the text in the
          web browser IS changed.</p>
        <br>
        <p>In the built
          version, the page that is displayed in the client is stored in</p>
        <p>app.e2134974ba17dc978fbd.bundle.js</p>
        <br>
        <p>When I change the
          text</p>
        <p>from</p>
        <p>&quot;version&quot;:
          &quot;2.10.0&quot;</p>
        <p>to</p>
        <p>&quot;version&quot;:
          &quot;3.45.6&quot;,</p>
        <p>and empty cache and
          hard reload in chrome, the change is working.</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc1891_3068016539"></a>2020-02-04</h2>
        <p>Introduced syntax
          error in
        </p>
        <p>
          <font face="Courier New, monospace">./src/main.js</font>
        </p>
        <p>ran</p>
        <p>
          <font face="Courier New, monospace">npm
            run eslint</font>
        </p>
        <p>but no error was
          indicated</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc1890_1586111487"></a>2020-02-05</h2>
        <p>If I add the line</p>
        <p>
          <font face="Courier New, monospace">console.log('hello');</font>
        </p>
        <p>to the file</p>
        <p>
          <font face="Courier New, monospace">./dist/cncjs/server-cli.js</font>
        </p>
        <p>and start the
          program, the word “hello” is being displayed.</p>
        <br>
        <p>When I change the
          name of the folder</p>
        <p>
          <font face="Courier New, monospace">./dist/cncjs/app</font>
        </p>
        <p>to</p>
        <p>
          <font face="Courier New, monospace">./dist/cncjs/app2</font>
        </p>
        <p>the server still
          starts but with errors</p>
        <br>
        <p>
          <font face="Courier New, monospace">Error:
            ENOENT: no such file or directory, stat
            '/media/data/nodeDevelop/cncjs/dist/cncjs/app/favicon.ico'</font>
        </p>
        <br>
        <p>This means that the
          web site data that is sent to the client (root of the web page) is at</p>
        <p>
          <font face="Courier New, monospace">./dist/cncjs/app</font>
        </p>
        <p>or for the source
          code, at</p>
        <p>
          <font face="Courier New, monospace">./src/cncjs/app</font>
        </p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2284_761723641"></a>2020-02-09</h2>
        <br>
        <p>The file</p>
        <br>
        <p>
          <font face="Courier New, monospace">.src/app/widgets/ProbingGrid/ProbingGrid.jsx</font>
        </p>
        <br>
        <p>uses the modules
          numeral and which is not part of the original cnc.js</p>
        <br>
        <p>When I run build I
          get error</p>
        <br>
        <p>[build-prod-app]
          /media/data/github/cncjs_1_10_0/src/app/widgets/ProbingGrid/ProbingGrid.jsx</p>
        <p>[build-prod-app]
          3:21 error Unable to resolve path to module 'numeral'
          import/no-unresolved</p>
        <p>[build-prod-app]
          4:24 error Unable to resolve path to module 'react-table'
          import/no-unresolved</p>
        <br>
        <p>After running</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            i react-table</font>
        </p>
        <p>
          <font face="Courier New, monospace">npm
            i numeral</font>
        </p>
        <br>
        <p>the errors are
          resolved.</p>
        <br>
        <h2 class="western"><a name="__RefHeading___Toc2356_4157620613"></a>2020-02-10</h2>
        <br>
        <p>What about the
          turnaround time to compile code changes?</p>
        <br>
        <p>Memory: 15.6 GiB</p>
        <p>Processor: Intel®
          Core™ i7-7500U CPU @ 2.70GHz × 4
        </p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-latest</font>
        </p>
        <p>takes 109 seconds</p>
        <p>Mon Feb 10 17:55:12
          CST 2020</p>
        <p>Mon Feb 10 17:57:01
          CST 2020</p>
        <br>
        <p>To compile only
          changes in /src/app source files:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-prod-app</font>
        </p>
        <p>takes 100 seconds</p>
        <p>Mon Feb 10 18:05:31
          CST 2020</p>
        <p>Mon Feb 10 18:07:11
          CST 2020</p>
        <br>
        <p>Running only the
          part where webpack is called</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-pa</font>
        </p>
        <p>where</p>
        <p> &quot;build-pa&quot;:
          &quot;cross-env NODE_ENV=production webpack-cli --config
          webpack.config.app.production.js&quot;,</p>
        <br>
        <p>takes 97 seconds</p>
        <p>Mon Feb 10 18:26:25
          CST 2020</p>
        <p>Mon Feb 10 18:28:02
          CST 2020</p>
        <br>
        <p>Using a RAM disk:</p>
        <br>
        <p>
          <font face="Courier New, monospace">npm
            run build-pa</font>
        </p>
        <br>
        <p>takes 96 seconds</p>
        <p>Tue Feb 11 16:47:46
          CST 2020</p>
        <p>Tue Feb 11 16:49:22
          CST 2020</p>
        <br>
        <p>Memory: 11.6 GiB</p>
        <p>Processor: Intel®
          CoreTM i7-8700 CPU @ 3.20GHz × 12</p>
        <p>npm run
          build-prod-app</p>
        <p>takes 69 seconds</p>
        <p>Tue Feb 11 22:54:08
          CST 2020</p>
        <p>Tue Feb 11 22:55:</p>
        <br>
        <h3 class="western"><a name="__RefHeading___Toc2382_399122378"></a>2020-02-12</h3>
        <br>
        <p>When I install cncjs
          1.10.0 and modify the code to add ProbingGrid, an error occurs when I
          check the probing grid in the widget manager and click ok.
        </p>
        <br>
        <p>The error occurred
          when I had rthe latest react-table module in package.json:</p>
        <br>
        <p>
          <font face="Courier New, monospace">&quot;dependencies&quot;:
            {</font>
        </p>
        <p>
          <font face="Courier New, monospace">&quot;react-table&quot;:
            &quot;^7.0.0-rc.15&quot;,</font>
        </p>
        <p>
          <font face="Courier New, monospace">}</font>
        </p>
        <br>
        <p>The error goes away
          when I change the version to the one that was working in version
          1.9.16-pre:</p>
        <br>
        <p>
          <font face="Courier New, monospace">&quot;dependencies&quot;:
            {</font>
        </p>
        <p>
          <font face="Courier New, monospace">&quot;react-table&quot;:
            &quot;~6.8.6&quot;,</font>
        </p>
        <p>
          <font face="Courier New, monospace">}</font>
        </p>
        <br>
        <h3 class="western"><a name="__RefHeading___Toc2511_3471171846"></a>2020-02-13</h3>
        <p>1.</p>
        <p>When I start the
          server with</p>
        <br>
        <p>
          <font face="Courier New, monospace">node
            bin/cncjs -vv</font>
        </p>
        <br>
        <p>Then the terminal
          shows the messsage</p>
        <br>
        <p>
          <font face="Courier New, monospace">
            <font size="2" style="font-size: 10pt">debug
              service:cncengine Loaded controllers: Grbl,Marlin,Smoothie,TinyG</font>
          </font>
        </p>
        <br>
        <p>This message is in</p>
        <br>
        <p>
          <font face="Courier New, monospace">./src/server/services/cncengine/CNCEngine.js</font>
        </p>
        <br>
        <p>and it loads and
          runs the class GrblController from</p>
        <br>
        <p>
          <font face="Courier New, monospace">./src/server/controllers/Grbl/GrblController.js</font>
        </p>
        <br>
        <h2 class="western" style="page-break-before: always"><a name="__RefHeading___Toc3042_1216396130"></a>
          2020-03-08</h2>
        <br>
        <p>Variables can passed
          from a class to another class that is declared as follows:</p>
        <br>
        <p>in index.js:</p>
        <br>
        <p>import
          ApplyAutoLevel from './ApplyAutoLevel';</p>
        <br>
        <p>state = {</p>
        <p> bla:7,</p>
        <p> ALgcode:
          ['bla', 'blo']</p>
        <p>};</p>
        <br>
        <p>and in render():</p>
        <p>
          &lt;ApplyAutoLevel state={state} actions={actions} /&gt;</p>
        <br>
        <p>and in
          ApplyAutoLevel.jsx:</p>
        <br>
        <p>inside any function</p>
        <br>
        <p> const {
          state, actions } = this.props;</p>
        <p> const { bla
          } = state;</p>
        <br>
        <p>The variable bla can
          now be read in ApplyAutoLevel.jsx.</p>
        <br>
        <p>Trying to write to a
          variable from within the declared class:</p>
        <br>
        <p>
          applyCompensation() {</p>
        <p> const {
          state, actions } = this.props;</p>
        <p>
          log.info('ApplyAutoLevel applyCompensation ALgcode \n' +
          state.Algcode);</p>
        <br>
        <p>ApplyAutoLevel
          applyCompensation ALgcode
        </p>
        <p>bla,blo
        </p>
        <br>
        <p>Then we write to
          state.Algcode</p>
        <br>
        <p>
          state.ALgcode = result;</p>
        <p>
          log.info('ApplyAutoLevel applyCompensation ALgcode:' +
          state.ALgcode);</p>
        <p>and we get whatever
          was in result.</p>
        <br>
        <p>However, in a call
          after that in index.js</p>
        <br>
        <p>
          log.info('AutoLevel/index.jsx ALgcode' + this.state.Algcode);</p>
        <br>
        <p>we get</p>
        <p>AutoLevel/index.jsx
          ALgcodebla,blo at Object.loadAutoLevelledGcode
        </p>
        <br>
        <p>again, so it was not
          changed in the declared class.</p>
        <br>
        <h1 class="western" style="page-break-before: always"><a name="__RefHeading___Toc2696_3123084980"></a>
          References</h1>
        <br>
        <p><a
            href="https://itnext.io/react-setstate-usage-and-gotchas-ac10b4e03d60">https://itnext.io/react-setstate-usage-and-gotchas-ac10b4e03d60</a>
        </p>
        <br>
        <p><a
            href="https://humanwhocodes.com/blog/2012/05/15/working-with-files-in-javascript-part-2/">https://humanwhocodes.com/blog/2012/05/15/working-with-files-in-javascript-part-2/</a>
        </p>
        <br>
        <p><a
            href="https://upmostly.com/tutorials/pass-a-parameter-through-onclick-in-react">https://upmostly.com/tutorials/pass-a-parameter-through-onclick-in-react</a>
        </p>
        <br>
      </div>

    </div>
    <div class="rightcolumn">
      <div class="card">
        <h3>Posts</h3>
        <a href="2018_11_nov.html">
          2018_11_nov.html</a><br>
        <a href="2020_03_march_01.html">
          2020_03_march_01.html</a><br>
        <a href="2022_12_dec_01.html">
          2022_12_dec_01.html</a><br>
        <a href="2022_12_dec_02.html">
          2022_12_dec_02.html</a><br>
        <a href="2023_03_mar.html">
          2023_03_mar.html</a><br>
        <a href="2023_07_jul.html">
          2023_07_jul.html</a><br>
        <a href="2023_08_aug.html">
          2023_08_aug.html</a><br>
        <br>
        <a href="description.html">
          description.html</a><br>
        <a href="developer.html">
          developer.html</a><br>
        <a href="fileChanges.html">
          fileChanges.html</a><br>
        <a href="debug_output.html">
          debug_output.html</a><br>
        <a href="faq.html">
          faq.html</a><br>
        <a href="software.html">
          software.html</a><br>
      </div>


      <div class="card">
        <h3>Follow Me</h3>
        <a href="https://discord.gg/F7KQySEW"><img src="../../images/discord.png" alt="discord" height="30"></a>
      </div>
    </div>
  </div>
  </div>
  <div class="footer">
    <h3>Modified July 2023</h3>  </div>
</body>

</html>