<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" href="../../css/blog.css" media="all" rel="stylesheet">
  <title></title>
</head>

<body>

  <div class="header">
    <table id="headerline">
      <tr>
        <td width="200">
          <a href="../../index.html"><img src="../../images/home.png" alt="home" height="60"></a>
          <a href="../../blogs/index.html"><img src="../../images/scroll.png" alt="scroll" height="60"></a>
          <a href="../../blogs/deno_learning/deno_learning.html"><img src="../../images/deno.png" alt="deno"
              height="60"></a>
        </td>
        <td>
          <h2>deno learning blog March 2023 </h2>
        </td>
      </tr>
    </table>
  </div>


  <div class="row">
    <div class="leftcolumn">


      <div class="card">
        <h2>Mar 1, 2023</h2>
        Problem:<br>
        using useEffect in order to read the database when the page is loaded:<br>
        the function readDatabase() triggers another useEffect which causes an infinite loop.<br>
        Solution:<br>
        give it an empty array as second argument<br>
        <a href="https://www.grepper.com/answers/31460/useeffect+only+on+mount">
          https://www.grepper.com/answers/31460/useeffect+only+on+mount</a><br>

        How to create a React Checkbox<br>
        <a href="https://www.robinwieruch.de/react-checkbox/">
          https://www.robinwieruch.de/react-checkbox/</a><br>


        Show/ hide an element:<br>
        <a href="https://stackoverflow.com/questions/24502898/show-or-hide-element-in-react">
          https://stackoverflow.com/questions/24502898/show-or-hide-element-in-react</a><br>

      </div>

      <div class="card">
        <h2>March 4, 2023</h2>
        <h4>database access with remult</h4>
        <p> Tutorial:<br>
          <a href="https://dev.to/yonirapoport/build-a-full-stack-crud-app-using-denos-fresh-and-postgres-4l39">
            https://dev.to/yonirapoport/build-a-full-stack-crud-app-using-denos-fresh-and-postgres-4l39</a><br>
        </p>
        <p> github repository:<br>
          <a href="https://github.com/yoni-rapoport/fresh-remult-todo">
            https://github.com/yoni-rapoport/fresh-remult-todo</a><br>
        </p>
        <a href="https://www.youtube.com/watch?v=rEoScmSVNUE">
          Create Express/Node + Postgres Backend for React App with CRUD, validation, and RBAC | Remult Demo

          <a href="https://deno.land/x/remult@v.0.18.0">
            https://deno.land/x/remult@v.0.18.0</a><br>
      </div>


      <div class="card">
        <h2>March 5, 2023</h2>
        <h4>deno Fresh remult example </h4>
        download the code from github<br>
        Running it, the program will work and store the data in a json file at<br>
        <div class="code">
          db/tasks.json
        </div>
        The contents are also visible at<br>
        <a href="http://localhost:8000/api/tasks">
          http://localhost:8000/api/tasks</a><br>


        How do we get the program to use a database for storage?<br>
        The file _middleware.ts contains the code<br>
        <div class="code">
          dataProvider: async () => {<br>
          const dbUrl = Deno.env.get("DATABASE_URL");<br>
          if (dbUrl) {<br>
          return createPostgresConnection({ connectionString: dbUrl });<br>
          }</div>

        What is the correct connectionString to work with Postgres?<br>
        The docs at<br>
        <a href="https://remult.dev/docs/databases.html#postgres">
          https://remult.dev/docs/databases.html#postgres</a><br>
        show a connectionString in an example:<br>
        <div class="code">
          const connectionString = "postgres://user:password@host:5432/database"
        </div>
        Changing the connectionString to

        <div class="code">
          "postgres://postgres:password@localhost:5432/at_data"
        </div>
        leads to error<br>

        <div class="code">
          PostgresError: password authentication failed for user "postgres"
        </div>

        <br>
        https://www.postgresql.org/docs/current/libpq-connect.html

        34.1.1.2. Connection URIs<br>

        https://www.connectionstrings.com/postgresql/

        <br>
        <br>
        <br>
        <br>
        <br>
        modifying the example code to work with a client object didn't work because of a password error<br>



      </div>

      <div class="card">
        <h2>March 7, 2023</h2>
        More on the ConnectionString:<br>
        <a href="https://deno.land/x/postgres@v0.17.0/mod.ts?s=Client">
          https://deno.land/x/postgres@v0.17.0/mod.ts?s=Client</a><br>

        <a href="https://deno.land/x/postgres@v0.17.0/mod.ts?s=ConnectionString">
          https://deno.land/x/postgres@v0.17.0/mod.ts?s=ConnectionString</a><br>


        Client(config?: ClientOptions | ConnectionString)<br>

        <p> Does the plain postgres module work with the same connectionString?<br>
          yes!<br>
        <div class="code">
          const dbUrl = "postgres://postgres:password@localhost:5432/sammy"<br>
          const client = new Client( dbUrl );
        </div>
        </p>
        <p>
          Observation:<br>
        <div class="code">
          return createPostgresConnection(1);<br>
          or<br>
          return createPostgresConnection("hello");<br>

        </div>
        leades to a different error:
        <div class="code">
          error: Uncaught (in promise) TypeError: Cannot create property 'poolSize' on number '1'<br>
          options.poolSize = 4;<br>
          or<br>
          error: Uncaught (in promise) TypeError: Cannot create property 'poolSize' on string 'hello'<br>
          options.poolSize = 4;<br>
        </div>
        </p>
      </div>

      <div class="card">
        <h2>March 9, 2023</h2>
        By adding a parameter in _middleware.ts that disables TLS, I can get rid of the TLS errors<br>
        <div class="code">
          configuration: {<br>
          tls: {enabled:false}<br>
          },
        </div>
        but I still get the error<br>
        <div class="code">
          PostgresError: password authentication failed for user "postgres"
        </div>
        Searching for "PostgresError(parseNoticeMessage(maybe_sasl_final));"<br>
        <a href="https://stackoverflow.com/questions/75162143/why-is-postgres-password-authentication-failing-in-deno">
          https://stackoverflow.com/questions/75162143/why-is-postgres-password-authentication-failing-in-deno</a><br>
        Using<br>
        <a href=https://github.com/denodrivers/postgres/issues/182#issuecomment-767004796>
          https://github.com/denodrivers/postgres/issues/182#issuecomment-767004796</a><br>
        and<br>
        <a href=https://askubuntu.com/questions/256534/how-do-i-find-the-path-to-pg-hba-conf-from-the-shell>
          https://askubuntu.com/questions/256534/how-do-i-find-the-path-to-pg-hba-conf-from-the-shell
        </a><br>
        modified the configuration file
        <div class="code">
          sudo nano /etc/postgresql/14/main/pg_hba.conf
        </div>
        and changed authentication method to password:<br>
        <div class="code">
          host all all 127.0.0.1/32 password
        </div>
        and restart Postgres<br>
        <div class="code">
          sudo systemctl restart postgresql
        </div>
        password error is now gone!<br>
        Now get error
        <div class="code">
          PostgresError: relation "tasks" does not exist
        </div>
        and Postgres log says<br>
        <div class="code">
          2023-03-09 20:21:45.819 CST [16941] postgres@sammy ERROR: relation "tasks" does not exist at character 35<br>
          2023-03-09 20:21:45.819 CST [16941] postgres@sammy STATEMENT: select id, title, completed
          from tasks Order By id
        </div>
        <p>
          Used pgadmin4 to create table named "tasks" and add the required columns<br>
          <img src="../../images/table_tasks.png" border="1" alt="hello World"><br>

          and it works!!!
        </p>
      </div>


      <div class="card">
        <h2>Date</h2>
        New Card
        <a href=> </a><br>
      </div>


    </div>

    <div class="rightcolumn">
      <div class="card">
        <h3>Posts by Date</h3>
        <a href="deno_learning_2022_12_dec.html">
          deno_learning_2022_12_dec.html</a><br>
        <a href="deno_learning_2023_01_jan.html">
          deno_learning_2023_01_jan.html</a><br>
        <a href="deno_learning_2023_02_feb.html">
          deno_learning_2023_02_feb.html</a><br>
        <a href="deno_learning_2023_03_mar.html">
          deno_learning_2023_03_mar.html</a><br>
        <br>
      </div>

      <div class="card">
        <h3>Follow Me</h3>
        <p>Some text..</p>
      </div>
    </div>
  </div>
  <div class="footer">
    <h2>More coming soon..<br></h2>
  </div>
</body>

</html>